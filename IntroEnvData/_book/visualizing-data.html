<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Visualizing data | Introduction to Environmental Data and R</title>
  <meta name="description" content="ENVST 206: Intro to Environmental Data, Hamilton College." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Visualizing data | Introduction to Environmental Data and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="ENVST 206: Intro to Environmental Data, Hamilton College." />
  <meta name="github-repo" content="kroppheather/Intro_Enviro_data" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Visualizing data | Introduction to Environmental Data and R" />
  
  <meta name="twitter:description" content="ENVST 206: Intro to Environmental Data, Hamilton College." />
  

<meta name="author" content="Heather Kropp" />


<meta name="date" content="2023-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"/>
<link rel="next" href="introduction-to-hypothesis-testing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction to Environmental Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#course-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Course Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html"><i class="fa fa-check"></i><b>2</b> Introduction to R Statistical Software</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#new-functions-syntax"><i class="fa fa-check"></i><b>2.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#first-some-terms"><i class="fa fa-check"></i><b>2.3</b> First some terms:</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#getting-to-know-rstudio-cloud"><i class="fa fa-check"></i><b>2.4</b> Getting to know Rstudio Cloud</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#introduction-to-r-rstudio"><i class="fa fa-check"></i><b>2.5</b> Introduction to R &amp; RStudio</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#r-basics"><i class="fa fa-check"></i><b>2.6</b> R basics</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#a-fancy-calculator"><i class="fa fa-check"></i><b>2.6.1</b> <em>A fancy calculator</em></a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#variables"><i class="fa fa-check"></i><b>2.6.2</b> <em>Variables</em></a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#vectors"><i class="fa fa-check"></i><b>2.6.3</b> <em>Vectors</em></a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> <em>Data frames</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><i class="fa fa-check"></i><b>3</b> Is this normal? Evaluating historical weather data to understand extremes, changes, and climate.</a>
<ul>
<li class="chapter" data-level="3.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#new-functions-syntax-1"><i class="fa fa-check"></i><b>3.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="3.3" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-1-the-problem.-how-weird-was-yesterdays-heatwave-using-long-term-weather-data-to-understand-normals-and-climate."><i class="fa fa-check"></i><b>3.3</b> <strong>Section 1:</strong> The problem. How weird was yesterday’s heatwave? Using long-term weather data to understand normals and climate.</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#using-summary-summary-statistics-to-summarize-weather"><i class="fa fa-check"></i><b>3.3.1</b> <em>Using summary summary statistics to summarize weather</em></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-2-the-data."><i class="fa fa-check"></i><b>3.4</b> <strong>Section 2:</strong> The Data.</a></li>
<li class="chapter" data-level="3.5" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#using-packages-in-r"><i class="fa fa-check"></i><b>3.5</b> Using packages in R</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#reading-in-data"><i class="fa fa-check"></i><b>3.5.1</b> <em>Reading in data</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#subsetting"><i class="fa fa-check"></i><b>3.5.2</b> <em>Subsetting</em></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-3a-the-approach.-summary-statistics-and-visualizing-data-distributions."><i class="fa fa-check"></i><b>3.6</b> <strong>Section 3a:</strong> The approach. Summary statistics and visualizing data distributions.</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#histograms"><i class="fa fa-check"></i><b>3.6.1</b> <em>Histograms</em></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-3b-probability-distributions"><i class="fa fa-check"></i><b>3.7</b> <strong>Section 3b:</strong> Probability distributions</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#normal-distributions"><i class="fa fa-check"></i><b>3.7.1</b> <em>Normal distributions</em></a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#the-normal-probability-distribution"><i class="fa fa-check"></i><b>3.8</b> <em>The normal probability distribution</em></a></li>
<li class="chapter" data-level="3.9" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#other-distributions"><i class="fa fa-check"></i><b>3.9</b> <em>Other distributions</em></a></li>
<li class="chapter" data-level="3.10" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#citations"><i class="fa fa-check"></i><b>3.10</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualizing-data.html"><a href="visualizing-data.html"><i class="fa fa-check"></i><b>4</b> Visualizing data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualizing-data.html"><a href="visualizing-data.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="visualizing-data.html"><a href="visualizing-data.html#new-functions-syntax-2"><i class="fa fa-check"></i><b>4.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="4.3" data-path="visualizing-data.html"><a href="visualizing-data.html#fundamentals-of-plotting-data"><i class="fa fa-check"></i><b>4.3</b> Fundamentals of plotting data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualizing-data.html"><a href="visualizing-data.html#representation-of-data"><i class="fa fa-check"></i><b>4.3.1</b> <em>1. Representation of data</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="visualizing-data.html"><a href="visualizing-data.html#layout"><i class="fa fa-check"></i><b>4.3.2</b> <em>2. Layout</em></a></li>
<li class="chapter" data-level="4.3.3" data-path="visualizing-data.html"><a href="visualizing-data.html#encoding"><i class="fa fa-check"></i><b>4.3.3</b> <em>3. Encoding</em></a></li>
<li class="chapter" data-level="4.3.4" data-path="visualizing-data.html"><a href="visualizing-data.html#simplicity"><i class="fa fa-check"></i><b>4.3.4</b> <em>4. Simplicity</em></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualizing-data.html"><a href="visualizing-data.html#plotting-data-in-base-r"><i class="fa fa-check"></i><b>4.4</b> Plotting data in base R</a></li>
<li class="chapter" data-level="4.5" data-path="visualizing-data.html"><a href="visualizing-data.html#using-packages-in-r-1"><i class="fa fa-check"></i><b>4.5</b> Using packages in R</a></li>
<li class="chapter" data-level="4.6" data-path="visualizing-data.html"><a href="visualizing-data.html#plotting-in-ggplot2"><i class="fa fa-check"></i><b>4.6</b> Plotting in ggplot2</a></li>
<li class="chapter" data-level="4.7" data-path="visualizing-data.html"><a href="visualizing-data.html#exploring-different-visualizations-in-ggplot2"><i class="fa fa-check"></i><b>4.7</b> Exploring different visualizations in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Introduction to hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#learning-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#new-functions-syntax-3"><i class="fa fa-check"></i><b>5.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#introduction-to-two-sample-t-tests"><i class="fa fa-check"></i><b>5.3</b> Introduction to two sample t-tests</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#the-data"><i class="fa fa-check"></i><b>5.3.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#study-goals-and-statistical-hypotheses"><i class="fa fa-check"></i><b>5.3.2</b> <em>Study goals and statistical hypotheses</em></a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#checking-assumptions-of-test"><i class="fa fa-check"></i><b>5.3.3</b> <em>Checking assumptions of test</em></a></li>
<li class="chapter" data-level="5.3.4" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#two-sample-t-test-in-r"><i class="fa fa-check"></i><b>5.3.4</b> <em>Two sample t-test in R</em></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#one-sample-t-test-in-r"><i class="fa fa-check"></i><b>5.4</b> One sample t-test in R</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#introduction-to-chi-squared-test"><i class="fa fa-check"></i><b>5.5</b> Introduction to chi-squared test</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#the-data-1"><i class="fa fa-check"></i><b>5.5.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="5.5.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#chi-squared-test"><i class="fa fa-check"></i><b>5.5.2</b> <em>Chi squared test</em></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#citations-1"><i class="fa fa-check"></i><b>5.6</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Introduction to linear regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#learning-objectives-4"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#new-functions-syntax-4"><i class="fa fa-check"></i><b>6.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#simple-linear-regression-are-beavers-flooding-the-arctic"><i class="fa fa-check"></i><b>6.3</b> Simple linear regression: Are beavers flooding the Arctic?</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-2"><i class="fa fa-check"></i><b>6.3.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="6.3.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#set-up-the-regression"><i class="fa fa-check"></i><b>6.3.2</b> <em>Set up the regression</em></a></li>
<li class="chapter" data-level="6.3.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#checking-assumptions"><i class="fa fa-check"></i><b>6.3.3</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="6.3.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#interpreting-results"><i class="fa fa-check"></i><b>6.3.4</b> <em>Interpreting results</em></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#multiple-linear-regression-what-makes-an-early-spring"><i class="fa fa-check"></i><b>6.4</b> Multiple linear regression: What makes an early spring?</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-3"><i class="fa fa-check"></i><b>6.4.1</b> <em>The data</em></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#panels-of-bivariate-plots"><i class="fa fa-check"></i><b>6.5</b> <em>Panels of bivariate plots</em></a></li>
<li class="chapter" data-level="6.6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#check-for-multi-collinearity"><i class="fa fa-check"></i><b>6.6</b> <em>Check for multi-collinearity</em></a></li>
<li class="chapter" data-level="6.7" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#run-the-regression"><i class="fa fa-check"></i><b>6.7</b> <em>Run the regression</em></a></li>
<li class="chapter" data-level="6.8" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#interpret-the-regression"><i class="fa fa-check"></i><b>6.8</b> <em>Interpret the regression</em></a></li>
<li class="chapter" data-level="6.9" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#citations-2"><i class="fa fa-check"></i><b>6.9</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>7</b> Introduction to Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#learning-objectives-5"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#new-functions-syntax-5"><i class="fa fa-check"></i><b>7.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#measuring-biodiversity-the-data"><i class="fa fa-check"></i><b>7.3</b> Measuring biodiversity: the data</a></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#anova-overview"><i class="fa fa-check"></i><b>7.4</b> ANOVA overview</a></li>
<li class="chapter" data-level="7.5" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#anova-in-r"><i class="fa fa-check"></i><b>7.5</b> ANOVA in R</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#checking-assumptions-1"><i class="fa fa-check"></i><b>7.5.1</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="7.5.2" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#running-the-anova"><i class="fa fa-check"></i><b>7.5.2</b> <em>Running the ANOVA</em></a></li>
<li class="chapter" data-level="7.5.3" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#post-hoc-comparisons"><i class="fa fa-check"></i><b>7.5.3</b> <em>Post hoc comparisons </em></a></li>
<li class="chapter" data-level="7.5.4" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#interpreting-the-results"><i class="fa fa-check"></i><b>7.5.4</b> <em>Interpreting the results </em></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#citations-3"><i class="fa fa-check"></i><b>7.6</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><i class="fa fa-check"></i><b>8</b> Advanced data wrangling. Linking soil moisture with landcover and rainfall.</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#learning-objectives-6"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#new-functions-syntax-6"><i class="fa fa-check"></i><b>8.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#soil-moisture"><i class="fa fa-check"></i><b>8.3</b> Soil moisture</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#soil-moisture-in-different-types-of-land-cover"><i class="fa fa-check"></i><b>8.3.1</b> Soil moisture in different types of land cover</a></li>
<li class="chapter" data-level="8.3.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#the-data-soil-moisture"><i class="fa fa-check"></i><b>8.3.2</b> The data: soil moisture</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#working-with-dates"><i class="fa fa-check"></i><b>8.4</b> Working with dates</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#the-lubridate-package"><i class="fa fa-check"></i><b>8.4.1</b> The lubridate package</a></li>
<li class="chapter" data-level="8.4.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#parsing-datetime"><i class="fa fa-check"></i><b>8.4.2</b> Parsing date/time</a></li>
<li class="chapter" data-level="8.4.3" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#extracting-information-from-dates"><i class="fa fa-check"></i><b>8.4.3</b> Extracting information from dates</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>8.5</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#filtering-data"><i class="fa fa-check"></i><b>8.5.1</b> Filtering data</a></li>
<li class="chapter" data-level="8.5.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#joining-data-tables"><i class="fa fa-check"></i><b>8.5.2</b> Joining data tables</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#conclusions"><i class="fa fa-check"></i><b>8.6</b> Conclusions</a></li>
<li class="chapter" data-level="8.7" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#citations-4"><i class="fa fa-check"></i><b>8.7</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualizing-data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Visualizing data<a href="visualizing-data.html#visualizing-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>by Heather Kropp</em>
<em>for ENVST 206: Introduction to Environmental Data</em>
<em>Hamilton College</em></p>
<div id="learning-objectives-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Learning objectives<a href="visualizing-data.html#learning-objectives-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Fundamentals of plotting data</li>
<li>Plotting data in base R</li>
<li>Learn about different visualization techniques in ggplot2</li>
<li>Characterize climate and weather data graphically</li>
</ol>
</div>
<div id="new-functions-syntax-2" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> New functions &amp; syntax<a href="visualizing-data.html#new-functions-syntax-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>n</code>,<code>plot</code>, <code>points</code>, <code>legend</code>,<code>ggplot</code>, <code>geom_point</code>,<code>geom_line</code>,<code>labs</code></p>
</div>
<div id="fundamentals-of-plotting-data" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Fundamentals of plotting data<a href="visualizing-data.html#fundamentals-of-plotting-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Visualizing data requires careful consideration of the audience and representation of the data. Many aesthetics and graphic design principles can aid in making engaging and accurate visualizations. There are several main principles to consider in visualizing data:</p>
<div id="representation-of-data" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> <em>1. Representation of data</em><a href="visualizing-data.html#representation-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The representation of data will depend on the type of data (categorical, discrete, proportion, numerical, etc.) and the uncertainty associated with the data. Keep in mind, uncertainty may be related to measurement error or simply showing the variation or spread of the data . Typically the type of data influences the type of graph that can be used. Below are a few examples of the underlying representation of data and associated error or variation.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="960" /></p>
<p>The choice in plot will depend on the representing uncertainty or variation (error bars, quantile boxplot), independence or ordering of variables (line versus scatter), and categorical versus numerical data (barplot, mosaic, pie).</p>
</div>
<div id="layout" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> <em>2. Layout</em><a href="visualizing-data.html#layout" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The layout describes all of the features and arrangement of the graph including labeling, axes range, the main graph frame. The objects included for both labeling and the physical centering and balance of the elements can all fall under layout.</p>
<center>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</center>
</div>
<div id="encoding" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> <em>3. Encoding</em><a href="visualizing-data.html#encoding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Encoding deals with the symbolization and representation of data. This can be related to colors, size of points or boxes, line weight, shading, or transparency. For encoding, you will want to consider aspects such as intuitive interpretation, accessibility, and cultural meaning.</p>
<center>
<img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="672" />
</center>
<p>In the above graph, colors are similar to the objects in the data and the point size represents large/small values. These types of intuitive encoding help with interpretation. However, for a broad audience, color-blind friendly and high contrast color may be more favorable over colors associated with objects or meaning. You will want to choose colors that will avoid confusion with other associations (like red colors for low values). You should also keep in mind that there are limitations in the number of hues that can be readily related to a number or object by most people. This means that encoding data via shading or hue can communicate general patterns for a large range of hue values, but does not offer the more accurate assessment that position or length can convey.</p>
</div>
<div id="simplicity" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> <em>4. Simplicity</em><a href="visualizing-data.html#simplicity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Too many colors, crowded points, complex shapes, and overlapping text all hamper the interpretation of data. In many contexts, there can be a lot of information to convey in a limited amount of space and audience attention span. Visualization often requires coordinating with text and the venue for the visualization to narrow in on the main focus and key takeaways from the visualization. Effective titles and labels can also play a role in visualization.</p>
</div>
</div>
<div id="plotting-data-in-base-r" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Plotting data in base R<a href="visualizing-data.html#plotting-data-in-base-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plots are one of the most useful tools for visualizing weather patterns and long term climate trends. We will work with the NOAA weather data from activity 2 to get more comfortable with making plots in R.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="visualizing-data.html#cb76-1" tabindex="-1"></a><span class="co"># read in data</span></span>
<span id="cb76-2"><a href="visualizing-data.html#cb76-2" tabindex="-1"></a><span class="co"># cloud is always lowercase</span></span>
<span id="cb76-3"><a href="visualizing-data.html#cb76-3" tabindex="-1"></a>datW <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/cloud/project/noaa_weather/weather_data.csv&quot;</span>)</span></code></pre></div>
<p>It can be helpful to set up a vector of the station names for easy reference. Working with station names as factors instead of characters often works better in some plotting functions. The <code>as.factor</code> function can convert the data. With this function, you can reassign the vector names as factors instead of characters. The <code>levels</code> function allows you to view each unique station name.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="visualizing-data.html#cb77-1" tabindex="-1"></a><span class="co"># specify that the name column should be a factor</span></span>
<span id="cb77-2"><a href="visualizing-data.html#cb77-2" tabindex="-1"></a>datW<span class="sc">$</span>NAME<span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datW<span class="sc">$</span>NAME)</span>
<span id="cb77-3"><a href="visualizing-data.html#cb77-3" tabindex="-1"></a><span class="co"># set up a vector of all names for each level</span></span>
<span id="cb77-4"><a href="visualizing-data.html#cb77-4" tabindex="-1"></a>nameS <span class="ot">&lt;-</span> <span class="fu">levels</span>(datW<span class="sc">$</span>NAME)</span>
<span id="cb77-5"><a href="visualizing-data.html#cb77-5" tabindex="-1"></a>nameS</span></code></pre></div>
<pre class="bg-info"><code>[1] &quot;ABERDEEN, WA US&quot;                              
[2] &quot;BARROW AIRPORT, AK US&quot;                        
[3] &quot;FARGO HECTOR INTERNATIONAL AIRPORT, ND US&quot;    
[4] &quot;PHOENIX AIRPORT, AZ US&quot;                       
[5] &quot;STILLWATER RESERVOIR, NY US&quot;                  
[6] &quot;SYRACUSE HANCOCK INTERNATIONAL AIRPORT, NY US&quot;</code></pre>
<p>Let’s start by taking a closer look at precipitation at each site. Just as you did in the previous chapter, totaling the precipitation that occurred in a year using the <code>summarise</code> and <code>group_by</code> function and sum will allow you to examine total annual precipitation. However, you want to avoid years with too many missing observations. In most cases involving missing observations, annual precipitation will be biased lower than the actual values of precipitation that fell. You would want to be careful comparing precipitation across sites and years when most of the the year is missing. It can be helpful to remove the <code>NA</code>s to sum the precipitation observations and account for the number of observations with real data. You will want to start by putting precipitation in a separate data frame and omitting <code>NA</code>s using the <code>na.omit</code> function. This will omit any row of data with an <code>NA</code> in it.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="visualizing-data.html#cb79-1" tabindex="-1"></a><span class="co"># remove NA using na.omit</span></span>
<span id="cb79-2"><a href="visualizing-data.html#cb79-2" tabindex="-1"></a>precipSub <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NAME=</span>datW<span class="sc">$</span>NAME,</span>
<span id="cb79-3"><a href="visualizing-data.html#cb79-3" tabindex="-1"></a>                           <span class="at">YEAR=</span>datW<span class="sc">$</span>YEAR,</span>
<span id="cb79-4"><a href="visualizing-data.html#cb79-4" tabindex="-1"></a>                           <span class="at">PRCP=</span>datW<span class="sc">$</span>PRCP)</span>
<span id="cb79-5"><a href="visualizing-data.html#cb79-5" tabindex="-1"></a>datP <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(precipSub)</span>
<span id="cb79-6"><a href="visualizing-data.html#cb79-6" tabindex="-1"></a><span class="co"># total annual precipitation (mm)</span></span>
<span id="cb79-7"><a href="visualizing-data.html#cb79-7" tabindex="-1"></a><span class="co"># use summarise to get total annual precipitation</span></span>
<span id="cb79-8"><a href="visualizing-data.html#cb79-8" tabindex="-1"></a>precip <span class="ot">&lt;-</span> precipSub <span class="sc">%&gt;%</span> </span>
<span id="cb79-9"><a href="visualizing-data.html#cb79-9" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME, YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb79-10"><a href="visualizing-data.html#cb79-10" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalP =</span> <span class="fu">sum</span>(PRCP), <span class="co"># sum all precip </span></span>
<span id="cb79-11"><a href="visualizing-data.html#cb79-11" tabindex="-1"></a>            <span class="at">ncount =</span> <span class="fu">n</span>()) <span class="co">#get the number of observations</span></span></code></pre></div>
<pre><code>`summarise()` has grouped output by &#39;NAME&#39;. You can override
using the `.groups` argument.</code></pre>
<p>If you scroll through the <code>ncount</code> column, you’ll see a lot of sites have a full year of observations 365/366, but some sites x years have a very low number of observations such as only 143 days.</p>
<p>Let’s remove years with too many missing precipitation measurements. There is not always a clear method to consider what might be acceptable amount of missing data. In this case, let’s allow for one to two days (depending on leap year) of missing data:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="visualizing-data.html#cb81-1" tabindex="-1"></a><span class="co"># make a new dataframe with observations at or above 364</span></span>
<span id="cb81-2"><a href="visualizing-data.html#cb81-2" tabindex="-1"></a>pr <span class="ot">&lt;-</span> precip <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="visualizing-data.html#cb81-3" tabindex="-1"></a>  <span class="fu">filter</span>(ncount <span class="sc">&gt;=</span><span class="dv">364</span>)</span></code></pre></div>
<p>Now let’s make a plot that looks at precipitation throughout the years. Let’s start by looking at the the town formally known as Barrow, Alaska (now known as Utqiagvik) and the Fargo, North Dakota data. Utqiagvik is a polar desert and Fargo is a cold, continental semi-arid area mostly consisting of prairie habitat. The sites are the second and third levels in our factor data. We can subset the entire data frame:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="visualizing-data.html#cb82-1" tabindex="-1"></a><span class="co"># look at only Utqiagvik (Barrow, AK) and Fargo, ND annual precipitation</span></span>
<span id="cb82-2"><a href="visualizing-data.html#cb82-2" tabindex="-1"></a>ak <span class="ot">&lt;-</span> pr <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="visualizing-data.html#cb82-3" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> nameS[<span class="dv">2</span>])</span>
<span id="cb82-4"><a href="visualizing-data.html#cb82-4" tabindex="-1"></a></span>
<span id="cb82-5"><a href="visualizing-data.html#cb82-5" tabindex="-1"></a>nd <span class="ot">&lt;-</span> pr <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="visualizing-data.html#cb82-6" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">==</span> nameS[<span class="dv">3</span>])</span></code></pre></div>
<p>Let’s start by looking at the basic plot in R using the Arizona data first using the <code>plot</code> function. The basic arguments involve data for the x axis and data for the y axis.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="visualizing-data.html#cb83-1" tabindex="-1"></a><span class="co"># make a plot of Alaska annual precipitation</span></span>
<span id="cb83-2"><a href="visualizing-data.html#cb83-2" tabindex="-1"></a><span class="fu">plot</span>(ak<span class="sc">$</span>YEAR, <span class="co"># x data</span></span>
<span id="cb83-3"><a href="visualizing-data.html#cb83-3" tabindex="-1"></a>     ak<span class="sc">$</span>totalP) <span class="co"># y data</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p>You’ll notice there are a few aspects of this plot that are difficult to read. There are so many years of observations, and it is difficult to track the year to year changes in precipitation. Adding lines can improve the readability of these sequential observations. It is also a good idea to keep the points since some years may be missing observations. With a few arguments the plot can be improved:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="visualizing-data.html#cb84-1" tabindex="-1"></a><span class="co"># make a plot of AK precipitation</span></span>
<span id="cb84-2"><a href="visualizing-data.html#cb84-2" tabindex="-1"></a><span class="fu">plot</span>(ak<span class="sc">$</span>YEAR, <span class="co"># x data</span></span>
<span id="cb84-3"><a href="visualizing-data.html#cb84-3" tabindex="-1"></a>     ak<span class="sc">$</span>totalP, <span class="co"># y data</span></span>
<span id="cb84-4"><a href="visualizing-data.html#cb84-4" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="co">#b = both points and lines added</span></span>
<span id="cb84-5"><a href="visualizing-data.html#cb84-5" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="co"># symbol shape to be a filled in circle</span></span>
<span id="cb84-6"><a href="visualizing-data.html#cb84-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Annual precipitation (mm)&quot;</span>, <span class="co">#y axis label</span></span>
<span id="cb84-7"><a href="visualizing-data.html#cb84-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>) <span class="co">#x axis label</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>You’ll also note that some of the y axis ticks are cut off because the plot window is too small and the labels are flipped in a hard to read direction. R doesn’t offer a lot of axes arguments within the plot function, but we can turn them off and add them separately with the <code>axis</code> function. You can turn all axes off in plot using the <code>axes=FALSE</code> argument or individual axis off. In this case, the x axis looks good so need to change it. <code>yaxt = "n"</code> turns off just the y axis.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="visualizing-data.html#cb85-1" tabindex="-1"></a><span class="co"># make a plot of Alaska precip</span></span>
<span id="cb85-2"><a href="visualizing-data.html#cb85-2" tabindex="-1"></a><span class="fu">plot</span>(ak<span class="sc">$</span>YEAR, ak<span class="sc">$</span>totalP,</span>
<span id="cb85-3"><a href="visualizing-data.html#cb85-3" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb85-4"><a href="visualizing-data.html#cb85-4" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb85-5"><a href="visualizing-data.html#cb85-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Annual precipitation (mm)&quot;</span>,</span>
<span id="cb85-6"><a href="visualizing-data.html#cb85-6" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb85-7"><a href="visualizing-data.html#cb85-7" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>) <span class="co"># turn off automatic labels on yaxis</span></span>
<span id="cb85-8"><a href="visualizing-data.html#cb85-8" tabindex="-1"></a><span class="co"># add y axis</span></span>
<span id="cb85-9"><a href="visualizing-data.html#cb85-9" tabindex="-1"></a><span class="co"># arguments are axis number (1 bottom, 2 left, 3 top, 4 right)</span></span>
<span id="cb85-10"><a href="visualizing-data.html#cb85-10" tabindex="-1"></a><span class="co"># las = 2 changes the labels to be read in horizontal direction</span></span>
<span id="cb85-11"><a href="visualizing-data.html#cb85-11" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">400</span>, <span class="at">by=</span><span class="dv">100</span>), <span class="at">las=</span><span class="dv">2</span> )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>The plot is looking much better! Now let’s add Fargo, ND for comparison. The <code>points</code> function adds points to an existing plot.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="visualizing-data.html#cb86-1" tabindex="-1"></a><span class="fu">plot</span>(ak<span class="sc">$</span>YEAR, ak<span class="sc">$</span>totalP,</span>
<span id="cb86-2"><a href="visualizing-data.html#cb86-2" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb86-3"><a href="visualizing-data.html#cb86-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb86-4"><a href="visualizing-data.html#cb86-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Annual precipitation (mm)&quot;</span>,</span>
<span id="cb86-5"><a href="visualizing-data.html#cb86-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb86-6"><a href="visualizing-data.html#cb86-6" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb86-7"><a href="visualizing-data.html#cb86-7" tabindex="-1"></a><span class="co"># add y axis</span></span>
<span id="cb86-8"><a href="visualizing-data.html#cb86-8" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">400</span>, <span class="at">by=</span><span class="dv">100</span>), <span class="at">las=</span><span class="dv">2</span> )</span>
<span id="cb86-9"><a href="visualizing-data.html#cb86-9" tabindex="-1"></a><span class="co"># add Fargo</span></span>
<span id="cb86-10"><a href="visualizing-data.html#cb86-10" tabindex="-1"></a><span class="fu">points</span>(nd<span class="sc">$</span>YEAR, nd<span class="sc">$</span>totalP, <span class="co"># x and y data</span></span>
<span id="cb86-11"><a href="visualizing-data.html#cb86-11" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="co"># points and lines</span></span>
<span id="cb86-12"><a href="visualizing-data.html#cb86-12" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="co"># filled in circle points</span></span>
<span id="cb86-13"><a href="visualizing-data.html#cb86-13" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;tomato3&quot;</span>) <span class="co"># change the color</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>Only one observation in North Dakota is within the range of the Alaska site. The rest of the data is not shown because it falls outside of the The axis range will need to be fixed so that all observations are visible for both sites. Here the <code>xlim</code> and <code>ylim</code> arguments change the range of the axes. These arguments expect a vector of two numbers: <code>ylim = c(minimum value, maximum value)</code>. This tells R the range on the axis to plot.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="visualizing-data.html#cb87-1" tabindex="-1"></a><span class="fu">plot</span>(ak<span class="sc">$</span>YEAR, ak<span class="sc">$</span>totalP,</span>
<span id="cb87-2"><a href="visualizing-data.html#cb87-2" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb87-3"><a href="visualizing-data.html#cb87-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb87-4"><a href="visualizing-data.html#cb87-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Annual precipitation (mm)&quot;</span>,</span>
<span id="cb87-5"><a href="visualizing-data.html#cb87-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb87-6"><a href="visualizing-data.html#cb87-6" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb87-7"><a href="visualizing-data.html#cb87-7" tabindex="-1"></a>     <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">900</span>)) <span class="co"># change the limits, c(lower, upper)</span></span>
<span id="cb87-8"><a href="visualizing-data.html#cb87-8" tabindex="-1"></a><span class="co">#add y axis</span></span>
<span id="cb87-9"><a href="visualizing-data.html#cb87-9" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">900</span>, <span class="at">by=</span><span class="dv">300</span>), <span class="at">las=</span><span class="dv">2</span> )</span>
<span id="cb87-10"><a href="visualizing-data.html#cb87-10" tabindex="-1"></a><span class="co">#add Fargo</span></span>
<span id="cb87-11"><a href="visualizing-data.html#cb87-11" tabindex="-1"></a><span class="fu">points</span>(nd<span class="sc">$</span>YEAR, nd<span class="sc">$</span>totalP,</span>
<span id="cb87-12"><a href="visualizing-data.html#cb87-12" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb87-13"><a href="visualizing-data.html#cb87-13" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb87-14"><a href="visualizing-data.html#cb87-14" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;tomato3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-74-1.png" width="768" /></p>
<p>There is just a couple of last considerations to finish the plot. You can add a legend to properly label the plot using <code>legend</code> function. The first argument specifies the placement using either the exact x,y coordinate or you use an argument for a more general position such as: <code>topleft</code>, <code>center</code>, <code>bottomright</code>. You could also add a line to indicate where the mean annual precipitation values are for each site using the <code>abline</code> function from tutorial 2. The <code>h=</code> argument adds a horizontal line at a value</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="visualizing-data.html#cb88-1" tabindex="-1"></a><span class="fu">plot</span>(ak<span class="sc">$</span>YEAR, ak<span class="sc">$</span>totalP,</span>
<span id="cb88-2"><a href="visualizing-data.html#cb88-2" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb88-3"><a href="visualizing-data.html#cb88-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb88-4"><a href="visualizing-data.html#cb88-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Annual precipitation (mm)&quot;</span>,</span>
<span id="cb88-5"><a href="visualizing-data.html#cb88-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb88-6"><a href="visualizing-data.html#cb88-6" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb88-7"><a href="visualizing-data.html#cb88-7" tabindex="-1"></a>     <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">900</span>))</span>
<span id="cb88-8"><a href="visualizing-data.html#cb88-8" tabindex="-1"></a><span class="co">#add y axis</span></span>
<span id="cb88-9"><a href="visualizing-data.html#cb88-9" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">900</span>, <span class="at">by=</span><span class="dv">300</span>), <span class="at">las=</span><span class="dv">2</span> )</span>
<span id="cb88-10"><a href="visualizing-data.html#cb88-10" tabindex="-1"></a><span class="co">#add  Fargo</span></span>
<span id="cb88-11"><a href="visualizing-data.html#cb88-11" tabindex="-1"></a><span class="fu">points</span>(nd<span class="sc">$</span>YEAR, nd<span class="sc">$</span>totalP,</span>
<span id="cb88-12"><a href="visualizing-data.html#cb88-12" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb88-13"><a href="visualizing-data.html#cb88-13" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb88-14"><a href="visualizing-data.html#cb88-14" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;tomato3&quot;</span>)</span>
<span id="cb88-15"><a href="visualizing-data.html#cb88-15" tabindex="-1"></a><span class="co">#add legend</span></span>
<span id="cb88-16"><a href="visualizing-data.html#cb88-16" tabindex="-1"></a></span>
<span id="cb88-17"><a href="visualizing-data.html#cb88-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="co">#position</span></span>
<span id="cb88-18"><a href="visualizing-data.html#cb88-18" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;Alaska&quot;</span>, <span class="st">&quot;North Dakota&quot;</span>), <span class="co">#labels</span></span>
<span id="cb88-19"><a href="visualizing-data.html#cb88-19" tabindex="-1"></a>       <span class="at">col=</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;tomato3&quot;</span>), <span class="co">#colors</span></span>
<span id="cb88-20"><a href="visualizing-data.html#cb88-20" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">19</span>, <span class="co">#point shape</span></span>
<span id="cb88-21"><a href="visualizing-data.html#cb88-21" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">1</span>, <span class="co">#line thickness 1, anytime both point &amp; line arguments are given both will be drawn</span></span>
<span id="cb88-22"><a href="visualizing-data.html#cb88-22" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">&quot;n&quot;</span>) <span class="co">#always use this argument otherwise an ugly box is drawn</span></span>
<span id="cb88-23"><a href="visualizing-data.html#cb88-23" tabindex="-1"></a></span>
<span id="cb88-24"><a href="visualizing-data.html#cb88-24" tabindex="-1"></a><span class="co">#add lines at the mean annual precipitation for each site</span></span>
<span id="cb88-25"><a href="visualizing-data.html#cb88-25" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span> <span class="fu">mean</span>(ak<span class="sc">$</span>totalP), <span class="co"># horizontal line at the mean</span></span>
<span id="cb88-26"><a href="visualizing-data.html#cb88-26" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;black&quot;</span>) <span class="co"># color set to black</span></span>
<span id="cb88-27"><a href="visualizing-data.html#cb88-27" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span> <span class="fu">mean</span>(nd<span class="sc">$</span>totalP), <span class="co"># line at nd mean</span></span>
<span id="cb88-28"><a href="visualizing-data.html#cb88-28" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;tomato3&quot;</span>) <span class="co"># color set to tomato3</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="768" /></p>
<center>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="768" /></p>
</center>
<center>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="768" /></p>
</center>
</div>
<div id="using-packages-in-r-1" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Using packages in R<a href="visualizing-data.html#using-packages-in-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have been learning to make plots using the built in functions in R including <code>plot</code> and <code>histogram</code>. While working with these basic plotting functions is useful, it can take a lot more coding to make a nicer looking figure. <strong>Packages</strong> add additional functions that are not located in the base functions in R. There are a total of 18,088 packages currently available on CRAN that expand the functions available in R. If you were to automatically have all of these packages and their functions loaded in R, it would take up space and too many functions would have the same name. This is why you should load only the packages needed to run the code in your script in an R session.</p>
<p>The first step in using a package, is to install it to your local computer using the <code>install.packages</code> function. <strong>You only need to do run this once for a project in RStudio Cloud.</strong> You will get a prompt asking what mirror you would like to download from. You may choose any mirror.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="visualizing-data.html#cb89-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>Once the package is installed, you will need to load the package into your current session using the <strong>library</strong> function. <strong>You will run this every time you start a new R session.</strong></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="visualizing-data.html#cb90-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
</div>
<div id="plotting-in-ggplot2" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Plotting in ggplot2<a href="visualizing-data.html#plotting-in-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>ggplot2</em> contains many different functions to make nice looking plots easily. You’ll notice we needed to run many lines of code to make the axes and points look nice. ggplot2 has developed a different plotting syntax than base R. The language of ggplot2 means that you declare the <strong>data</strong> that you are using, the <strong>coordinate system</strong>, and the <strong>geometry</strong> to be used in the plot. The <strong>data</strong> refers to the data source and the <strong>aesthetics</strong>. In the <strong>aesthetics</strong> you define the x, y coordinate specifications and any other information on the size or colors to be used. The <strong>coordinate system</strong> specifies how to plot the data graphically. By default it refers to a <strong>cartesian</strong> coordinate system which simply means plotting on a x,y axis. You don’t need to specify this plotting component if you are making a cartesian graph. The <strong>geometry</strong> refers to the shapes/type of plot to be used (ex: bars, boxes, points). You can find a cheat sheet for ggplot2 here: <a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf</a></p>
<p>Let’s get a feel for using ggplot by looking at the annual precipitation across years for all of the sites. You’ll notice that ggplot2 also uses <code>+</code> signs to connect multiple functions. This is unique to this type of package and other packages made by the same developers. It does not work for functions outside of these packages</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="visualizing-data.html#cb91-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pr, <span class="fu">aes</span>(<span class="at">x =</span> YEAR, <span class="at">y=</span>totalP, <span class="at">color=</span>NAME ) )<span class="sc">+</span> <span class="co"># data for plot</span></span>
<span id="cb91-2"><a href="visualizing-data.html#cb91-2" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span> <span class="co"># make points at data point</span></span>
<span id="cb91-3"><a href="visualizing-data.html#cb91-3" tabindex="-1"></a>        <span class="fu">geom_line</span>()<span class="sc">+</span> <span class="co"># use lines to connect data points</span></span>
<span id="cb91-4"><a href="visualizing-data.html#cb91-4" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;year&quot;</span>, <span class="at">y=</span><span class="st">&quot;Annual Precipitation&quot;</span>) <span class="co"># make axis labels</span></span></code></pre></div>
<pre><code>Warning: Removed 11 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>Warning: Removed 2 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-80-1.png" width="768" /></p>
<p>You’ll notice a legend is automatically made and the y axis labels are in the right direction. There’s just a couple more things. I personally <em>dislike</em> the gray gridlines. A lot of people like them and that’s fine if you like them. Let’s look at how we can get rid of them by changing the theme.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="visualizing-data.html#cb94-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pr, <span class="fu">aes</span>(<span class="at">x =</span> YEAR, <span class="at">y=</span>totalP, <span class="at">color=</span>NAME ) )<span class="sc">+</span> <span class="co"># data for plot</span></span>
<span id="cb94-2"><a href="visualizing-data.html#cb94-2" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span> <span class="co"># make points at data point</span></span>
<span id="cb94-3"><a href="visualizing-data.html#cb94-3" tabindex="-1"></a>        <span class="fu">geom_line</span>()<span class="sc">+</span> <span class="co"># use lines to connect data points</span></span>
<span id="cb94-4"><a href="visualizing-data.html#cb94-4" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;year&quot;</span>, <span class="at">y=</span><span class="st">&quot;Annual Precipitation&quot;</span>)<span class="sc">+</span> <span class="co"># make axis labels</span></span>
<span id="cb94-5"><a href="visualizing-data.html#cb94-5" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="co"># change plot theme</span></span></code></pre></div>
<pre><code>Warning: Removed 11 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>Warning: Removed 2 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="768" /></p>
<p>It also would be helpful to change the colors and make them semi-transparent so we can see what sites overlap a little better. You can manually change the colors in Rstudio using the <code>scale_color_manual</code> setting. Note in R, you can enter colors as color names: such as <code>"tomato3"</code>, the hex code, or you can use the rgb() function to designate the amount of red, green, and blue that goes into making a color. There are a lot of color resources online that can help you pick colors. If you search for the color <em>tomato3</em> in google, you will get results from color websites that give the hex codes or the red,green, blue composition. In the case of <em>tomato3</em>, the hex code is <code>#CD4F39</code> and the red, green, blue composition is <code>rgb(0.8, 0.31,0.22)</code>. You can find more information on color theory and colors in R here: <a href="https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf" class="uri">https://www.nceas.ucsb.edu/sites/default/files/2020-04/colorPaletteCheatsheet.pdf</a></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="visualizing-data.html#cb97-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pr, <span class="fu">aes</span>(<span class="at">x =</span> YEAR, <span class="at">y=</span>totalP, <span class="at">color=</span>NAME ) )<span class="sc">+</span></span>
<span id="cb97-2"><a href="visualizing-data.html#cb97-2" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb97-3"><a href="visualizing-data.html#cb97-3" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb97-4"><a href="visualizing-data.html#cb97-4" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;year&quot;</span>, <span class="at">y=</span><span class="st">&quot;Annual Precipitation (mm)&quot;</span>)<span class="sc">+</span></span>
<span id="cb97-5"><a href="visualizing-data.html#cb97-5" tabindex="-1"></a>        <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb97-6"><a href="visualizing-data.html#cb97-6" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#7FB3D5&quot;</span>,<span class="st">&quot;#34495E&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>,<span class="st">&quot;#26A69A&quot;</span>,<span class="st">&quot;#58504A&quot;</span>))</span></code></pre></div>
<pre><code>Warning: Removed 11 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>Warning: Removed 2 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-82-1.png" width="768" /></p>
</div>
<div id="exploring-different-visualizations-in-ggplot2" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Exploring different visualizations in ggplot2<a href="visualizing-data.html#exploring-different-visualizations-in-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the main considerations in data visualizations is using the proper type of geometry to display data. Let’s look at making different types of plots in ggplot2.</p>
<p>Violin plots are a way to display data across categories in a manner that conveys more information than a barplot showing the mean. The violins are created using a mirrored histogram of the data that is smoothed out into a line. Each distribution is displayed around the name with wider parts of the violin representing values on the y axis that occur more frequently within a group. Typically violins are paired with a boxplot in the violin to show the quartiles (25% and 75% of the data ranges), median, and 95% range within the distribution. In ggplot2, violin plots are easy to make. Let’s focus on minimum temperatures for this next part. Let’s take a look at the daily minimum temperatures in Alaska, Washington, and Stillwater Reservoir.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="visualizing-data.html#cb100-1" tabindex="-1"></a><span class="co"># subset so that data can come from AK, Stillwater, or WA</span></span>
<span id="cb100-2"><a href="visualizing-data.html#cb100-2" tabindex="-1"></a>plotSub <span class="ot">&lt;-</span> datW <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="visualizing-data.html#cb100-3" tabindex="-1"></a>  <span class="fu">filter</span>(datW<span class="sc">$</span>NAME <span class="sc">==</span> nameS[<span class="dv">1</span>] <span class="sc">|</span></span>
<span id="cb100-4"><a href="visualizing-data.html#cb100-4" tabindex="-1"></a>                datW<span class="sc">$</span>NAME <span class="sc">==</span> nameS[<span class="dv">2</span>] <span class="sc">|</span></span>
<span id="cb100-5"><a href="visualizing-data.html#cb100-5" tabindex="-1"></a>                datW<span class="sc">$</span>NAME <span class="sc">==</span> nameS[<span class="dv">5</span>])</span>
<span id="cb100-6"><a href="visualizing-data.html#cb100-6" tabindex="-1"></a></span>
<span id="cb100-7"><a href="visualizing-data.html#cb100-7" tabindex="-1"></a></span>
<span id="cb100-8"><a href="visualizing-data.html#cb100-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plotSub, <span class="fu">aes</span>(<span class="at">x=</span>NAME, <span class="at">y=</span>TMIN))<span class="sc">+</span> <span class="co"># look at daily tmin</span></span>
<span id="cb100-9"><a href="visualizing-data.html#cb100-9" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">fill=</span><span class="fu">rgb</span>(<span class="fl">0.933</span>,<span class="fl">0.953</span>,<span class="fl">0.98</span>))<span class="sc">+</span> <span class="co"># add a violin plot with blue color</span></span>
<span id="cb100-10"><a href="visualizing-data.html#cb100-10" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.2</span>,<span class="at">size=</span><span class="fl">0.25</span>, <span class="at">fill=</span><span class="st">&quot;grey90&quot;</span>)<span class="sc">+</span> <span class="co"># add grey </span></span>
<span id="cb100-11"><a href="visualizing-data.html#cb100-11" tabindex="-1"></a>  <span class="co">#boxplots and make them about 20% smaller </span></span>
<span id="cb100-12"><a href="visualizing-data.html#cb100-12" tabindex="-1"></a>  <span class="co">#than normal with 25% thinner lines than normal</span></span>
<span id="cb100-13"><a href="visualizing-data.html#cb100-13" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="co"># get rid of ugly gridlines</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-83-1.png" width="1056" /></p>
<p>You may get a warning message that there were non-finite values. That’s warning you that <code>NA</code> values were omitted. No problem that they were removed so you can ignore that message.</p>
<p>Let’s wrap up by looking at one other component of plotting that will be useful. Let’s take a closer look at daily patterns within a year in Syracuse NY in 2020.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="visualizing-data.html#cb101-1" tabindex="-1"></a>sub <span class="ot">&lt;-</span> datW <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="visualizing-data.html#cb101-2" tabindex="-1"></a>  <span class="fu">filter</span>(datW<span class="sc">$</span>NAME <span class="sc">==</span> nameS[<span class="dv">6</span>] <span class="sc">&amp;</span> datW<span class="sc">$</span>YEAR <span class="sc">==</span> <span class="dv">2020</span>)</span></code></pre></div>
<p>It will be helpful to work with dates on the x-axis now. Right now, R thinks the dates are characters. Let’s change that to a date format. There are many ways to format a date: <em>01-28-2020</em> and <em>01/28/2020</em> both refer to the same date. You have to specify that you want your data to be treated like a date, but you also have to indicate how it is formatted. <strong>as.Date</strong> indicates the vector of data should be considered a date.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="visualizing-data.html#cb102-1" tabindex="-1"></a><span class="co"># specify date format</span></span>
<span id="cb102-2"><a href="visualizing-data.html#cb102-2" tabindex="-1"></a><span class="co"># %Y means a four number year </span></span>
<span id="cb102-3"><a href="visualizing-data.html#cb102-3" tabindex="-1"></a><span class="co"># - indicates that the date uses dashes to separate</span></span>
<span id="cb102-4"><a href="visualizing-data.html#cb102-4" tabindex="-1"></a><span class="co"># %m means month</span></span>
<span id="cb102-5"><a href="visualizing-data.html#cb102-5" tabindex="-1"></a><span class="co"># %d means day</span></span>
<span id="cb102-6"><a href="visualizing-data.html#cb102-6" tabindex="-1"></a>sub<span class="sc">$</span>DATE <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(sub<span class="sc">$</span>DATE,<span class="st">&quot;%Y-%m-%d&quot;</span>)</span></code></pre></div>
<p>You can find other types of formatting for dates here: <a href="https://www.statmethods.net/input/dates.html" class="uri">https://www.statmethods.net/input/dates.html</a></p>
<p>Now when you made plot with date on the x axis in ggplot, you’ll see nicely labeled date information automatically provided.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="visualizing-data.html#cb103-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sub, <span class="fu">aes</span>(<span class="at">x=</span>DATE, <span class="at">y=</span>TMAX))<span class="sc">+</span></span>
<span id="cb103-2"><a href="visualizing-data.html#cb103-2" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb103-3"><a href="visualizing-data.html#cb103-3" tabindex="-1"></a>        <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb103-4"><a href="visualizing-data.html#cb103-4" tabindex="-1"></a>        <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb103-5"><a href="visualizing-data.html#cb103-5" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;year&quot;</span>, <span class="at">y=</span><span class="st">&quot;Maximimum temperature (C)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p>In one last plot example, lets look at a barplot. Barplots are helpful for precipitation since we are often looking at totals for a day or year and in many cases do not have variability in each value.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="visualizing-data.html#cb104-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sub, <span class="fu">aes</span>(<span class="at">x=</span>DATE, <span class="at">y=</span>PRCP))<span class="sc">+</span></span>
<span id="cb104-2"><a href="visualizing-data.html#cb104-2" tabindex="-1"></a>        <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;royalblue3&quot;</span>)<span class="sc">+</span></span>
<span id="cb104-3"><a href="visualizing-data.html#cb104-3" tabindex="-1"></a>        <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb104-4"><a href="visualizing-data.html#cb104-4" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;year&quot;</span>, <span class="at">y=</span><span class="st">&quot;Daily precipitation (mm)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<center>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="768" /></p>
<center>
<p><img src="_main_files/figure-html/unnamed-chunk-89-1.png" width="768" /></p>
</center>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-hypothesis-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-vis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
