<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Introduction to Analysis of Variance (ANOVA) | Introduction to Environmental Data and R</title>
  <meta name="description" content="ENVST 206: Intro to Environmental Data, Hamilton College" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Introduction to Analysis of Variance (ANOVA) | Introduction to Environmental Data and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="ENVST 206: Intro to Environmental Data, Hamilton College" />
  <meta name="github-repo" content="kroppheather/Intro_Enviro_data" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Introduction to Analysis of Variance (ANOVA) | Introduction to Environmental Data and R" />
  
  <meta name="twitter:description" content="ENVST 206: Intro to Environmental Data, Hamilton College" />
  

<meta name="author" content="Heather Kropp" />


<meta name="date" content="2023-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-linear-regression.html"/>
<link rel="next" href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#course-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Course Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#license"><i class="fa fa-check"></i><b>1.2</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html"><i class="fa fa-check"></i><b>2</b> Introduction to R Statistical Software</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#new-functions-syntax"><i class="fa fa-check"></i><b>2.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#first-some-terms"><i class="fa fa-check"></i><b>2.3</b> First some terms:</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#getting-to-know-rstudio-cloud"><i class="fa fa-check"></i><b>2.4</b> Getting to know Rstudio Cloud</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#introduction-to-r-rstudio"><i class="fa fa-check"></i><b>2.5</b> Introduction to R &amp; RStudio</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#r-basics"><i class="fa fa-check"></i><b>2.6</b> R basics</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#a-fancy-calculator"><i class="fa fa-check"></i><b>2.6.1</b> <em>A fancy calculator</em></a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#variables"><i class="fa fa-check"></i><b>2.6.2</b> <em>Variables</em></a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#vectors"><i class="fa fa-check"></i><b>2.6.3</b> <em>Vectors</em></a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> <em>Data frames</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><i class="fa fa-check"></i><b>3</b> Is this normal? Evaluating historical weather data to understand extremes, changes, and climate.</a>
<ul>
<li class="chapter" data-level="3.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#new-functions-syntax-1"><i class="fa fa-check"></i><b>3.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="3.3" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#the-problem.-how-weird-was-yesterdays-heatwave-using-long-term-weather-data-to-understand-normals-and-climate."><i class="fa fa-check"></i><b>3.3</b> The problem. How weird was yesterday’s heatwave? Using long-term weather data to understand normals and climate.</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#using-summary-summary-statistics-to-summarize-weather"><i class="fa fa-check"></i><b>3.3.1</b> <em>Using summary summary statistics to summarize weather</em></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#the-data."><i class="fa fa-check"></i><b>3.4</b> The Data.</a></li>
<li class="chapter" data-level="3.5" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#using-packages-in-r"><i class="fa fa-check"></i><b>3.5</b> Using packages in R</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#reading-in-data"><i class="fa fa-check"></i><b>3.5.1</b> <em>Reading in data</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#subsetting"><i class="fa fa-check"></i><b>3.5.2</b> <em>Subsetting</em></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#summary-statistics-and-visualizing-data-distributions."><i class="fa fa-check"></i><b>3.6</b> Summary statistics and visualizing data distributions.</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#histograms"><i class="fa fa-check"></i><b>3.6.1</b> <em>Histograms</em></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#probability-distributions"><i class="fa fa-check"></i><b>3.7</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#normal-distributions"><i class="fa fa-check"></i><b>3.7.1</b> <em>Normal distributions</em></a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#the-normal-probability-distribution"><i class="fa fa-check"></i><b>3.8</b> <em>The normal probability distribution</em></a></li>
<li class="chapter" data-level="3.9" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#other-distributions"><i class="fa fa-check"></i><b>3.9</b> <em>Other distributions</em></a></li>
<li class="chapter" data-level="3.10" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#citations"><i class="fa fa-check"></i><b>3.10</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualizing-data.html"><a href="visualizing-data.html"><i class="fa fa-check"></i><b>4</b> Visualizing data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualizing-data.html"><a href="visualizing-data.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="visualizing-data.html"><a href="visualizing-data.html#new-functions-syntax-2"><i class="fa fa-check"></i><b>4.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="4.3" data-path="visualizing-data.html"><a href="visualizing-data.html#fundamentals-of-plotting-data"><i class="fa fa-check"></i><b>4.3</b> Fundamentals of plotting data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualizing-data.html"><a href="visualizing-data.html#representation-of-data"><i class="fa fa-check"></i><b>4.3.1</b> <em>1. Representation of data</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="visualizing-data.html"><a href="visualizing-data.html#layout"><i class="fa fa-check"></i><b>4.3.2</b> <em>2. Layout</em></a></li>
<li class="chapter" data-level="4.3.3" data-path="visualizing-data.html"><a href="visualizing-data.html#encoding"><i class="fa fa-check"></i><b>4.3.3</b> <em>3. Encoding</em></a></li>
<li class="chapter" data-level="4.3.4" data-path="visualizing-data.html"><a href="visualizing-data.html#simplicity"><i class="fa fa-check"></i><b>4.3.4</b> <em>4. Simplicity</em></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualizing-data.html"><a href="visualizing-data.html#plotting-data-in-base-r"><i class="fa fa-check"></i><b>4.4</b> Plotting data in base R</a></li>
<li class="chapter" data-level="4.5" data-path="visualizing-data.html"><a href="visualizing-data.html#using-ggplot2"><i class="fa fa-check"></i><b>4.5</b> Using <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.6" data-path="visualizing-data.html"><a href="visualizing-data.html#plotting-in-ggplot2"><i class="fa fa-check"></i><b>4.6</b> Plotting in ggplot2</a></li>
<li class="chapter" data-level="4.7" data-path="visualizing-data.html"><a href="visualizing-data.html#exploring-different-visualizations-in-ggplot2"><i class="fa fa-check"></i><b>4.7</b> Exploring different visualizations in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Introduction to hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#learning-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#new-functions-syntax-3"><i class="fa fa-check"></i><b>5.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#introduction-to-two-sample-t-tests"><i class="fa fa-check"></i><b>5.3</b> Introduction to two sample t-tests</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#the-data"><i class="fa fa-check"></i><b>5.3.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#study-goals-and-statistical-hypotheses"><i class="fa fa-check"></i><b>5.3.2</b> <em>Study goals and statistical hypotheses</em></a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#checking-assumptions-of-test"><i class="fa fa-check"></i><b>5.3.3</b> <em>Checking assumptions of test</em></a></li>
<li class="chapter" data-level="5.3.4" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#two-sample-t-test-in-r"><i class="fa fa-check"></i><b>5.3.4</b> <em>Two sample t-test in R</em></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#one-sample-t-test-in-r"><i class="fa fa-check"></i><b>5.4</b> One sample t-test in R</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#introduction-to-chi-squared-test"><i class="fa fa-check"></i><b>5.5</b> Introduction to chi-squared test</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#the-data-1"><i class="fa fa-check"></i><b>5.5.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="5.5.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#chi-squared-test"><i class="fa fa-check"></i><b>5.5.2</b> <em>Chi squared test</em></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#citations-1"><i class="fa fa-check"></i><b>5.6</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Introduction to linear regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#learning-objectives-4"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#new-functions-syntax-4"><i class="fa fa-check"></i><b>6.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#simple-linear-regression-are-beavers-flooding-the-arctic"><i class="fa fa-check"></i><b>6.3</b> Simple linear regression: Are beavers flooding the Arctic?</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-2"><i class="fa fa-check"></i><b>6.3.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="6.3.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#set-up-the-regression"><i class="fa fa-check"></i><b>6.3.2</b> <em>Set up the regression</em></a></li>
<li class="chapter" data-level="6.3.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#checking-assumptions"><i class="fa fa-check"></i><b>6.3.3</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="6.3.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#interpreting-results"><i class="fa fa-check"></i><b>6.3.4</b> <em>Interpreting results</em></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#multiple-linear-regression-what-makes-an-early-spring"><i class="fa fa-check"></i><b>6.4</b> Multiple linear regression: What makes an early spring?</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-3"><i class="fa fa-check"></i><b>6.4.1</b> <em>The data</em></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#panels-of-bivariate-plots"><i class="fa fa-check"></i><b>6.5</b> <em>Panels of bivariate plots</em></a></li>
<li class="chapter" data-level="6.6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#check-for-multi-collinearity"><i class="fa fa-check"></i><b>6.6</b> <em>Check for multi-collinearity</em></a></li>
<li class="chapter" data-level="6.7" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#run-the-regression"><i class="fa fa-check"></i><b>6.7</b> <em>Run the regression</em></a></li>
<li class="chapter" data-level="6.8" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#interpret-the-regression"><i class="fa fa-check"></i><b>6.8</b> <em>Interpret the regression</em></a></li>
<li class="chapter" data-level="6.9" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#citations-2"><i class="fa fa-check"></i><b>6.9</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>7</b> Introduction to Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#learning-objectives-5"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#new-functions-syntax-5"><i class="fa fa-check"></i><b>7.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#measuring-biodiversity-the-data"><i class="fa fa-check"></i><b>7.3</b> Measuring biodiversity: the data</a></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#anova-overview"><i class="fa fa-check"></i><b>7.4</b> ANOVA overview</a></li>
<li class="chapter" data-level="7.5" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#anova-in-r"><i class="fa fa-check"></i><b>7.5</b> ANOVA in R</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#checking-assumptions-1"><i class="fa fa-check"></i><b>7.5.1</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="7.5.2" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#running-the-anova"><i class="fa fa-check"></i><b>7.5.2</b> <em>Running the ANOVA</em></a></li>
<li class="chapter" data-level="7.5.3" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#post-hoc-comparisons"><i class="fa fa-check"></i><b>7.5.3</b> <em>Post hoc comparisons </em></a></li>
<li class="chapter" data-level="7.5.4" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#interpreting-the-results"><i class="fa fa-check"></i><b>7.5.4</b> <em>Interpreting the results </em></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#citations-3"><i class="fa fa-check"></i><b>7.6</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><i class="fa fa-check"></i><b>8</b> Advanced data wrangling. Linking soil moisture with landcover and rainfall.</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#learning-objectives-6"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#new-functions-syntax-6"><i class="fa fa-check"></i><b>8.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#soil-moisture"><i class="fa fa-check"></i><b>8.3</b> Soil moisture</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#soil-moisture-in-different-types-of-land-cover"><i class="fa fa-check"></i><b>8.3.1</b> Soil moisture in different types of land cover</a></li>
<li class="chapter" data-level="8.3.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#the-data-soil-moisture"><i class="fa fa-check"></i><b>8.3.2</b> The data: soil moisture</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#working-with-dates"><i class="fa fa-check"></i><b>8.4</b> Working with dates</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#the-lubridate-package"><i class="fa fa-check"></i><b>8.4.1</b> The lubridate package</a></li>
<li class="chapter" data-level="8.4.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#parsing-datetime"><i class="fa fa-check"></i><b>8.4.2</b> Parsing date/time</a></li>
<li class="chapter" data-level="8.4.3" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#extracting-information-from-dates"><i class="fa fa-check"></i><b>8.4.3</b> Extracting information from dates</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>8.5</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#filtering-data"><i class="fa fa-check"></i><b>8.5.1</b> Filtering data</a></li>
<li class="chapter" data-level="8.5.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#joining-data-tables"><i class="fa fa-check"></i><b>8.5.2</b> Joining data tables</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#conclusions"><i class="fa fa-check"></i><b>8.6</b> Conclusions</a></li>
<li class="chapter" data-level="8.7" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#citations-4"><i class="fa fa-check"></i><b>8.7</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-analysis-of-variance-anova" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Introduction to Analysis of Variance (ANOVA)<a href="introduction-to-analysis-of-variance-anova.html#introduction-to-analysis-of-variance-anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>by Heather Kropp</em>
<em>for ENVST 206: Introduction to Environmental Data</em>
<em>Hamilton College</em></p>
<div id="learning-objectives-5" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Learning objectives<a href="introduction-to-analysis-of-variance-anova.html#learning-objectives-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Work with data related to measures of biodiversity</li>
<li>Learn to conduct an ANOVA in R</li>
<li>Visualize and interpret ANOVA</li>
</ol>
</div>
<div id="new-functions-syntax-5" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> New functions &amp; syntax<a href="introduction-to-analysis-of-variance-anova.html#new-functions-syntax-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>aov</code>, <code>TukeyHSD</code></p>
</div>
<div id="measuring-biodiversity-the-data" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Measuring biodiversity: the data<a href="introduction-to-analysis-of-variance-anova.html#measuring-biodiversity-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A decline in <strong>biodiversity</strong> is a common environmental concern. Biodiversity is a concept related to a wide range in the number of species (plant, fungi, and animal) and abundance of populations in a species. Anthropogenic impacts on the environment via habitat loss, increased global temperatures, and pollution can all negatively impact the abundance of living organisms. Extinction of organisms as a result of these impacts is decreasing biodiversity. There are a number of ways to measure biodiversity. <strong>Species richness</strong> is the number of different types of species present in a particular location. It is typically measured as a numerical count of species and collected from observations that look for presence/absence of different species. <strong>Diversity indices</strong> account for both the number of different types of species and the evenness of the number of individuals in each type of species.</p>
<p>The urban environment can affect survival and reproduction of some insect species. Urban built environments are often warmer environments with less water availability, particularly in drier regions of California. Buildings and pavement can remove habitat and warmer temperatures on these surfaces may render them unsuitable for insects. Residential areas of urban environments can provide more vegetated environments, but plant cover is often not native and mostly dominated by a single plant cover such as grass. Some insects may be well equipped to survive in many urban environments and there is a concern that urbanization can drive declines in the diversity of insects. This may negatively impact essential part of ecosystems driving pollination, the food web, and the decomposition of plant material.</p>
<p>To evaluate the impact of the urban environment on insects, Adams <em>et al.</em> (2019) trapped insects across the Los Angeles area and examined the number of species at each location. Below is a map of sampling locations used in the study across differing levels of urbanization.</p>
<center>
<p><img src="photos/tutorial_6/Los_Angeles_Aerial_view_2013.jpg" style="width:70.0%" /></p>
<p><em>Aerial view of Los Angeles area highlights the varying levels of urbanization from the highly devleoped areas of commercial complexes and downtown to mountain parks Source: Tuxyso, CC BY-SA 3.0, via Wikimedia Commons</em></p>
</center>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="introduction-to-analysis-of-variance-anova.html#cb149-1" tabindex="-1"></a><span class="co">#read in insect data</span></span>
<span id="cb149-2"><a href="introduction-to-analysis-of-variance-anova.html#cb149-2" tabindex="-1"></a>datI <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/cloud/project/activity06/insect_richness.csv&quot;</span>)</span></code></pre></div>
<pre class="bg-info"><code>  urbanType urbanName Richness lawn
1         3  Suburban       30  Yes
2         8 Developed        3  Yes
3         9     Dense       22   No
4         9     Dense        1  Yes
5         8 Developed       22   No
6         8 Developed       15   No</code></pre>
<p>As you learned in class, ANOVA is a widely used technique for testing for differences in three or more groups. ANOVA will be useful for examining the insect species richness across an urban gradient in Los Angles. The <code>Richness</code> and the <code>urbanName</code> column will be used for the test. <code>urbanName</code> gives the type of urban environment the species richness was measured in. You will want to specify <code>urbanName</code> as a factor to work best in the ANOVA. The <code>urbanType</code> column provides an identifying number originally used in by the authors. We are only focusing on a few urban areas in this analysis. Below is a table that provides a more detailed description of each area used in the study site. The numbers in the table coincide with the <code>urbanType</code> column.</p>
<center>
<img src="photos/tutorial_6/urbanclass.png" style="width:40.0%" />
_Table describing urban type classification from Adams <em>et al.</em> (2019)
</center>
<p>It will be helpful to convert the names to factors in R.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="introduction-to-analysis-of-variance-anova.html#cb151-1" tabindex="-1"></a>datI<span class="sc">$</span>urbanName <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datI<span class="sc">$</span>urbanName)</span></code></pre></div>
</div>
<div id="anova-overview" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> ANOVA overview<a href="introduction-to-analysis-of-variance-anova.html#anova-overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In ANOVA, the F statistic is used to evaluate differences in data between groups. Here the F-ratio that we use for our statistical evaluation is calculated based on the variance of the data around the mean. First the <strong>among group (SS<sub>among</sub>, sometimes referred to as between)</strong> sum of squares calculates the squared difference between each group mean and the overall mean of all the data and sums up the differences for all groups. The <strong>within group (SS<sub>within</sub>, also referred to as residual)</strong> sum of squares calculates the squared difference between each data observation and its group mean and sums these differences for all observations. The <strong>mean squares</strong> is then calculated using the number of groups (<em>SS<sub>among</sub></em>) and both the number of groups and observations (<em>SS<sub>within</sub></em>). This table also shows the total SS for good measure, but we don’t often look at it since <em>SS<sub>total</sub></em> = <em>SS<sub>among</sub></em> + <em>SS<sub>within</sub></em>. The F-ratio is calculated by dividing the mean square for among groups by within groups. The p-value provides a probability for observing the calculated F-ratio and all values greater under the null distribution. You will want to use the standard confidence level of 0.05 to make your assessment.</p>
<center>
<p>Source | Degrees of freedom | Sum of Squares | Mean square | F-ratio
______________|_______________________|____________________|_____________|_________
Among groups | <em>a-1</em> | <span class="math inline">\(\sum_{i=1}^{a}\sum_{j=1}^{n}(\overline{Y_i}-\overline{Y})^{2}\)</span> | <span class="math inline">\(\frac{SS_{among}}{a-1}\)</span> | <span class="math inline">\(\frac{MS_{among}}{MS_{within}}\)</span>
Within groups | <em>a(n-1)</em> | <span class="math inline">\(\sum_{i=1}^{a}\sum_{j=1}^{n}({Y_{ij}}-\overline{Y_{i}})^{2}\)</span> | - | -</p>
<p>Here <em>a</em> represents the total number of groups and <em>n</em> represents the number of observations within groups.</p>
</div>
<div id="anova-in-r" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> ANOVA in R<a href="introduction-to-analysis-of-variance-anova.html#anova-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="checking-assumptions-1" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> <em>Checking assumptions</em><a href="introduction-to-analysis-of-variance-anova.html#checking-assumptions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next you will run the ANOVA test on the insect data to examine whether the different urban environments impact species richness. Before checking the assumptions, it’s a good idea to visualize the data. I’ll show the data using the plots from class that help visualize the different values used in ANOVA. The grey points show individual observations overlain on the boxplot for each group. The red points show the group mean and the blue line shows the mean for all the data.</p>
<img src="Intro-EnvData_files/figure-html/unnamed-chunk-143-1.png" width="672" />
</center>
<p>The first assumption is <strong>normality</strong> for each group. You must check normality for each individual group. Don’t forget that <code>unique</code> can be helpful for getting the names for each group:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="introduction-to-analysis-of-variance-anova.html#cb152-1" tabindex="-1"></a><span class="fu">unique</span>(datI<span class="sc">$</span>urbanName)</span></code></pre></div>
<pre class="bg-info"><code>[1] Suburban  Developed Dense     Natural  
Levels: Dense Developed Natural Suburban</code></pre>
<p>The sample size is small enough to use the Shapiro Wilk’s test.</p>
<pre class="bg-info"><code>
    Shapiro-Wilk normality test

data:  datI$Richness[datI$urbanName == &quot;Suburban&quot;]
W = 0.98087, p-value = 0.2461</code></pre>
<pre class="bg-info"><code>
    Shapiro-Wilk normality test

data:  datI$Richness[datI$urbanName == &quot;Developed&quot;]
W = 0.96155, p-value = 0.05604</code></pre>
<pre class="bg-info"><code>
    Shapiro-Wilk normality test

data:  datI$Richness[datI$urbanName == &quot;Dense&quot;]
W = 0.97508, p-value = 0.1025</code></pre>
<pre class="bg-info"><code>
    Shapiro-Wilk normality test

data:  datI$Richness[datI$urbanName == &quot;Natural&quot;]
W = 0.91559, p-value = 0.2514</code></pre>
<p>The null hypothesis is that the data are normally distributed. Here, each group is higher than our confidencle level of 0.05.</p>
<p>The second assumption of <strong>equal variance</strong> can be checked with the Bartlett test.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="introduction-to-analysis-of-variance-anova.html#cb158-1" tabindex="-1"></a><span class="fu">bartlett.test</span>(datI<span class="sc">$</span>Richness<span class="sc">~</span>datI<span class="sc">$</span>urbanName)</span></code></pre></div>
<pre class="bg-info"><code>
    Bartlett test of homogeneity of variances

data:  datI$Richness by datI$urbanName
Bartlett&#39;s K-squared = 1.2091, df = 3, p-value = 0.7508</code></pre>
<p>Both equal variance and normality assumptions are appropriate for the data. The other assumptions are that observations are <strong>independent</strong> of each other and <strong>correctly classified</strong> in each group. Since this data comes from a peer reviewed study that uses the same type of statistics (frequentist), we can assume that the research design and data are set up to meet these assumptions.</p>
</div>
<div id="running-the-anova" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> <em>Running the ANOVA</em><a href="introduction-to-analysis-of-variance-anova.html#running-the-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that you’ve had a chance to check the assumptions and visualize the data, you are ready to run the ANOVA in R. There are two steps to this test in R. You first specify a linear model with the <code>lm</code> function. The next step is to run the ANOVA calcluations using <code>aov</code> function. Both of these functions will simply run the calculations. To view the ANOVA table of results, you will print the table using the <code>summary</code> function. In the <code>lm</code> function we will specify a formula <code>Richness ~ Urban</code>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="introduction-to-analysis-of-variance-anova.html#cb160-1" tabindex="-1"></a><span class="co">#specify model for species richness and urban type</span></span>
<span id="cb160-2"><a href="introduction-to-analysis-of-variance-anova.html#cb160-2" tabindex="-1"></a>in.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(datI<span class="sc">$</span>Richness <span class="sc">~</span> datI<span class="sc">$</span>urbanName)</span>
<span id="cb160-3"><a href="introduction-to-analysis-of-variance-anova.html#cb160-3" tabindex="-1"></a><span class="co">#run the ANOVA</span></span>
<span id="cb160-4"><a href="introduction-to-analysis-of-variance-anova.html#cb160-4" tabindex="-1"></a>in.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(in.mod)</span>
<span id="cb160-5"><a href="introduction-to-analysis-of-variance-anova.html#cb160-5" tabindex="-1"></a><span class="co">#print out ANOVA table</span></span>
<span id="cb160-6"><a href="introduction-to-analysis-of-variance-anova.html#cb160-6" tabindex="-1"></a><span class="fu">summary</span>(in.aov)</span></code></pre></div>
<pre class="bg-info"><code>                Df Sum Sq Mean Sq F value  Pr(&gt;F)   
datI$urbanName   3   1944   647.9   4.898 0.00254 **
Residuals      236  31216   132.3                   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Here the table will print out such that the upper row labeled with our group vector name (<code>datI$urbanName</code>) is our <em>among group</em> variability (sum of squares for group means compared to overall mean) and the <code>residuals</code> row is the <em>within group</em> variability. You can see the F value in the upper right part of the table and the associated p-value.</p>
</div>
<div id="post-hoc-comparisons" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> <em>Post hoc comparisons </em><a href="introduction-to-analysis-of-variance-anova.html#post-hoc-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ANOVA results alone do not give us a complete picture of the differences between urban landcover types. Some groups actually look quite similar. You must check to see how the means compare between groups to make a full statistical conclusion. You would want to highlight that only some groups may differ from each other when drawing conclusions about the urban environment impacts on species richness. This pairwise comparison between groups is called a post hoc test. Tukey’s HSD (Honestly Significant Difference) test can be used to conduct this comparison.There is a simple built in function in R. You just have to give the name of the variable that has the ANOVA results.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="introduction-to-analysis-of-variance-anova.html#cb162-1" tabindex="-1"></a><span class="co">#run Tukey HSD</span></span>
<span id="cb162-2"><a href="introduction-to-analysis-of-variance-anova.html#cb162-2" tabindex="-1"></a>tukeyT <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(in.aov)</span>
<span id="cb162-3"><a href="introduction-to-analysis-of-variance-anova.html#cb162-3" tabindex="-1"></a><span class="co">#view results</span></span>
<span id="cb162-4"><a href="introduction-to-analysis-of-variance-anova.html#cb162-4" tabindex="-1"></a>tukeyT</span></code></pre></div>
<pre class="bg-info"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = in.mod)

$`datI$urbanName`
                        diff         lwr        upr     p adj
Developed-Dense     1.433333  -3.5966663  6.4633329 0.8819569
Natural-Dense      12.583333   3.3998525 21.7668141 0.0026479
Suburban-Dense      3.785714  -0.8060261  8.3774547 0.1456297
Natural-Developed  11.150000   1.7397324 20.5602676 0.0128693
Suburban-Developed  2.352381  -2.6776186  7.3823805 0.6210733
Suburban-Natural   -8.797619 -17.9810999  0.3858618 0.0658910</code></pre>
<p>Here you will notice that there are two group names in each row indicating which groups are being compared. A significant difference between groups means that the confidence interval in the difference between the means will not overlap with zero and will have a p-value below our confidence level threshold of 0.05. Note that this test prints a <code>p-adj</code> value. This means it has made some adjustments to account for the fact that were a comparing many means and should account for this in our calculations.</p>
<p>You can also use the <code>plot</code> function and input the entire test variable to generate a plot that shows the confidence levels for the mean comparisons. This can help you get a better visualization for how close these intervals are to zero since there are a lot of numbers printed out in the table.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="introduction-to-analysis-of-variance-anova.html#cb164-1" tabindex="-1"></a><span class="co">#make a plot</span></span>
<span id="cb164-2"><a href="introduction-to-analysis-of-variance-anova.html#cb164-2" tabindex="-1"></a><span class="co">#make axes labels smaller than usual to fit on plot using cex.axis </span></span>
<span id="cb164-3"><a href="introduction-to-analysis-of-variance-anova.html#cb164-3" tabindex="-1"></a><span class="fu">plot</span>(tukeyT, <span class="at">cex.axis=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="Intro-EnvData_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
</div>
<div id="interpreting-the-results" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> <em>Interpreting the results </em><a href="introduction-to-analysis-of-variance-anova.html#interpreting-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you interpret ANOVA results, you will want to summarize the test results, the means and difference between means, and make a plot that visualizes the data in each group.</p>
<p>Typically a bar or box plot is used to show the means or quartiles of each group with letters above the data to indicate when groups are similar. For example, an ANOVA with four groups that all significantly differed from each other would show a different letter for each group like a,b,c,d. </p>
<p>The Tukey HSD results indicate that the Dense, Developed, and Suburban are all similar. Natural differs from Dense and Developed, but not Suburban. Multiple letters can be used for a group. Dense, Developed, and Suburban all get the letter <code>a</code>. Natural will get the letter <code>b</code>. Since Suburban is similar to Natural, it will also get a <code>b</code>.</p>
<p>The best way to add labels to a base plot in R is the the <code>text</code> function. The arguments are <code>text(x coordinates, y coordinates, text labels to add)</code>. In the code below, the coordinates and labels will be set up as vectors.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="introduction-to-analysis-of-variance-anova.html#cb165-1" tabindex="-1"></a><span class="co"># box plot</span></span>
<span id="cb165-2"><a href="introduction-to-analysis-of-variance-anova.html#cb165-2" tabindex="-1"></a><span class="fu">plot</span>(datI<span class="sc">$</span>Richness <span class="sc">~</span> datI<span class="sc">$</span>urbanName, </span>
<span id="cb165-3"><a href="introduction-to-analysis-of-variance-anova.html#cb165-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Urban surface&quot;</span>,</span>
<span id="cb165-4"><a href="introduction-to-analysis-of-variance-anova.html#cb165-4" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">&quot;Insect species Richness&quot;</span>,</span>
<span id="cb165-5"><a href="introduction-to-analysis-of-variance-anova.html#cb165-5" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>))</span>
<span id="cb165-6"><a href="introduction-to-analysis-of-variance-anova.html#cb165-6" tabindex="-1"></a><span class="co"># x coordinates for labels</span></span>
<span id="cb165-7"><a href="introduction-to-analysis-of-variance-anova.html#cb165-7" tabindex="-1"></a>xname <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&quot;Dense&quot;</span>,<span class="st">&quot;Developed&quot;</span>,<span class="st">&quot;Natural&quot;</span>,<span class="st">&quot;Suburban&quot;</span>))</span>
<span id="cb165-8"><a href="introduction-to-analysis-of-variance-anova.html#cb165-8" tabindex="-1"></a><span class="co"># y coordinates for labels</span></span>
<span id="cb165-9"><a href="introduction-to-analysis-of-variance-anova.html#cb165-9" tabindex="-1"></a>ylabel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">55</span>,<span class="dv">50</span>,<span class="dv">55</span>)</span>
<span id="cb165-10"><a href="introduction-to-analysis-of-variance-anova.html#cb165-10" tabindex="-1"></a><span class="co"># labels to add</span></span>
<span id="cb165-11"><a href="introduction-to-analysis-of-variance-anova.html#cb165-11" tabindex="-1"></a>textName <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a,b&quot;</span>)</span>
<span id="cb165-12"><a href="introduction-to-analysis-of-variance-anova.html#cb165-12" tabindex="-1"></a><span class="co"># add letters to existing plot</span></span>
<span id="cb165-13"><a href="introduction-to-analysis-of-variance-anova.html#cb165-13" tabindex="-1"></a><span class="fu">text</span>(xname, <span class="co">#x coordinate</span></span>
<span id="cb165-14"><a href="introduction-to-analysis-of-variance-anova.html#cb165-14" tabindex="-1"></a>     ylabel, <span class="co">#y coordinate</span></span>
<span id="cb165-15"><a href="introduction-to-analysis-of-variance-anova.html#cb165-15" tabindex="-1"></a>     textName) <span class="co"># labels</span></span></code></pre></div>
<p><img src="Intro-EnvData_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<center>
<img src="Intro-EnvData_files/figure-html/unnamed-chunk-151-1.png" width="768" />
</center>
</div>
</div>
<div id="citations-3" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Citations<a href="introduction-to-analysis-of-variance-anova.html#citations-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Insect Species Richness</strong>
Adams, B., E. Li, C. Bahlai, E. Meineke, T. McGlynn, and B. Brown. (2020). Local- and landscape-scale variables shape insect diversity in an urban biodiversity hot spot. <em>Ecological Applications</em>. 30: e02089.</p>
<p><em>Data citation</em>
Adams, Benjamin et al. (2020), Local and landscape scale variables shape insect diversity in an urban biodiversity hotspot., v2, Dryad, Dataset, <a href="https://doi.org/10.5061/dryad.7d7wm37rd" class="uri">https://doi.org/10.5061/dryad.7d7wm37rd</a></p>

<hr />
<p>output:
html_document:
theme: yeti
highlight: pygments
—</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
