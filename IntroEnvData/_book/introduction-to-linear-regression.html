<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Introduction to linear regression | Introduction to Environmental Data and R</title>
  <meta name="description" content="ENVST 206: Intro to Environmental Data, Hamilton College." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Introduction to linear regression | Introduction to Environmental Data and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="ENVST 206: Intro to Environmental Data, Hamilton College." />
  <meta name="github-repo" content="kroppheather/Intro_Enviro_data" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Introduction to linear regression | Introduction to Environmental Data and R" />
  
  <meta name="twitter:description" content="ENVST 206: Intro to Environmental Data, Hamilton College." />
  

<meta name="author" content="Heather Kropp" />


<meta name="date" content="2023-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-hypothesis-testing.html"/>
<link rel="next" href="introduction-to-analysis-of-variance-anova.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction to Environmental Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#course-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Course Learning objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html"><i class="fa fa-check"></i><b>2</b> Introduction to R Statistical Software</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#new-functions-syntax"><i class="fa fa-check"></i><b>2.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#first-some-terms"><i class="fa fa-check"></i><b>2.3</b> First some terms:</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#getting-to-know-rstudio-cloud"><i class="fa fa-check"></i><b>2.4</b> Getting to know Rstudio Cloud</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#introduction-to-r-rstudio"><i class="fa fa-check"></i><b>2.5</b> Introduction to R &amp; RStudio</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#r-basics"><i class="fa fa-check"></i><b>2.6</b> R basics</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#a-fancy-calculator"><i class="fa fa-check"></i><b>2.6.1</b> <em>A fancy calculator</em></a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#variables"><i class="fa fa-check"></i><b>2.6.2</b> <em>Variables</em></a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#vectors"><i class="fa fa-check"></i><b>2.6.3</b> <em>Vectors</em></a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r-statistical-software.html"><a href="introduction-to-r-statistical-software.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> <em>Data frames</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><i class="fa fa-check"></i><b>3</b> Is this normal? Evaluating historical weather data to understand extremes, changes, and climate.</a>
<ul>
<li class="chapter" data-level="3.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#new-functions-syntax-1"><i class="fa fa-check"></i><b>3.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="3.3" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-1-the-problem.-how-weird-was-yesterdays-heatwave-using-long-term-weather-data-to-understand-normals-and-climate."><i class="fa fa-check"></i><b>3.3</b> <strong>Section 1:</strong> The problem. How weird was yesterday’s heatwave? Using long-term weather data to understand normals and climate.</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#using-summary-summary-statistics-to-summarize-weather"><i class="fa fa-check"></i><b>3.3.1</b> <em>Using summary summary statistics to summarize weather</em></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-2-the-data."><i class="fa fa-check"></i><b>3.4</b> <strong>Section 2:</strong> The Data.</a></li>
<li class="chapter" data-level="3.5" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#using-packages-in-r"><i class="fa fa-check"></i><b>3.5</b> Using packages in R</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#reading-in-data"><i class="fa fa-check"></i><b>3.5.1</b> <em>Reading in data</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#subsetting"><i class="fa fa-check"></i><b>3.5.2</b> <em>Subsetting</em></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-3a-the-approach.-summary-statistics-and-visualizing-data-distributions."><i class="fa fa-check"></i><b>3.6</b> <strong>Section 3a:</strong> The approach. Summary statistics and visualizing data distributions.</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#histograms"><i class="fa fa-check"></i><b>3.6.1</b> <em>Histograms</em></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#section-3b-probability-distributions"><i class="fa fa-check"></i><b>3.7</b> <strong>Section 3b:</strong> Probability distributions</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#normal-distributions"><i class="fa fa-check"></i><b>3.7.1</b> <em>Normal distributions</em></a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#the-normal-probability-distribution"><i class="fa fa-check"></i><b>3.8</b> <em>The normal probability distribution</em></a></li>
<li class="chapter" data-level="3.9" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#other-distributions"><i class="fa fa-check"></i><b>3.9</b> <em>Other distributions</em></a></li>
<li class="chapter" data-level="3.10" data-path="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html"><a href="is-this-normal-evaluating-historical-weather-data-to-understand-extremes-changes-and-climate..html#citations"><i class="fa fa-check"></i><b>3.10</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualizing-data.html"><a href="visualizing-data.html"><i class="fa fa-check"></i><b>4</b> Visualizing data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualizing-data.html"><a href="visualizing-data.html#learning-objectives-2"><i class="fa fa-check"></i><b>4.1</b> Learning objectives</a></li>
<li class="chapter" data-level="4.2" data-path="visualizing-data.html"><a href="visualizing-data.html#new-functions-syntax-2"><i class="fa fa-check"></i><b>4.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="4.3" data-path="visualizing-data.html"><a href="visualizing-data.html#fundamentals-of-plotting-data"><i class="fa fa-check"></i><b>4.3</b> Fundamentals of plotting data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualizing-data.html"><a href="visualizing-data.html#representation-of-data"><i class="fa fa-check"></i><b>4.3.1</b> <em>1. Representation of data</em></a></li>
<li class="chapter" data-level="4.3.2" data-path="visualizing-data.html"><a href="visualizing-data.html#layout"><i class="fa fa-check"></i><b>4.3.2</b> <em>2. Layout</em></a></li>
<li class="chapter" data-level="4.3.3" data-path="visualizing-data.html"><a href="visualizing-data.html#encoding"><i class="fa fa-check"></i><b>4.3.3</b> <em>3. Encoding</em></a></li>
<li class="chapter" data-level="4.3.4" data-path="visualizing-data.html"><a href="visualizing-data.html#simplicity"><i class="fa fa-check"></i><b>4.3.4</b> <em>4. Simplicity</em></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualizing-data.html"><a href="visualizing-data.html#plotting-data-in-base-r"><i class="fa fa-check"></i><b>4.4</b> Plotting data in base R</a></li>
<li class="chapter" data-level="4.5" data-path="visualizing-data.html"><a href="visualizing-data.html#using-packages-in-r-1"><i class="fa fa-check"></i><b>4.5</b> Using packages in R</a></li>
<li class="chapter" data-level="4.6" data-path="visualizing-data.html"><a href="visualizing-data.html#plotting-in-ggplot2"><i class="fa fa-check"></i><b>4.6</b> Plotting in ggplot2</a></li>
<li class="chapter" data-level="4.7" data-path="visualizing-data.html"><a href="visualizing-data.html#exploring-different-visualizations-in-ggplot2"><i class="fa fa-check"></i><b>4.7</b> Exploring different visualizations in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Introduction to hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#learning-objectives-3"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#new-functions-syntax-3"><i class="fa fa-check"></i><b>5.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#introduction-to-two-sample-t-tests"><i class="fa fa-check"></i><b>5.3</b> Introduction to two sample t-tests</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#the-data"><i class="fa fa-check"></i><b>5.3.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#study-goals-and-statistical-hypotheses"><i class="fa fa-check"></i><b>5.3.2</b> <em>Study goals and statistical hypotheses</em></a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#checking-assumptions-of-test"><i class="fa fa-check"></i><b>5.3.3</b> <em>Checking assumptions of test</em></a></li>
<li class="chapter" data-level="5.3.4" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#two-sample-t-test-in-r"><i class="fa fa-check"></i><b>5.3.4</b> <em>Two sample t-test in R</em></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#one-sample-t-test-in-r"><i class="fa fa-check"></i><b>5.4</b> One sample t-test in R</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#introduction-to-chi-squared-test"><i class="fa fa-check"></i><b>5.5</b> Introduction to chi-squared test</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#the-data-1"><i class="fa fa-check"></i><b>5.5.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="5.5.2" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#chi-squared-test"><i class="fa fa-check"></i><b>5.5.2</b> <em>Chi squared test</em></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-hypothesis-testing.html"><a href="introduction-to-hypothesis-testing.html#citations-1"><i class="fa fa-check"></i><b>5.6</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Introduction to linear regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#learning-objectives-4"><i class="fa fa-check"></i><b>6.1</b> Learning objectives</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#new-functions-syntax-4"><i class="fa fa-check"></i><b>6.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#simple-linear-regression-are-beavers-flooding-the-arctic"><i class="fa fa-check"></i><b>6.3</b> Simple linear regression: Are beavers flooding the Arctic?</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-2"><i class="fa fa-check"></i><b>6.3.1</b> <em>The data</em></a></li>
<li class="chapter" data-level="6.3.2" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#set-up-the-regression"><i class="fa fa-check"></i><b>6.3.2</b> <em>Set up the regression</em></a></li>
<li class="chapter" data-level="6.3.3" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#checking-assumptions"><i class="fa fa-check"></i><b>6.3.3</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="6.3.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#interpreting-results"><i class="fa fa-check"></i><b>6.3.4</b> <em>Interpreting results</em></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#multiple-linear-regression-what-makes-an-early-spring"><i class="fa fa-check"></i><b>6.4</b> Multiple linear regression: What makes an early spring?</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#the-data-3"><i class="fa fa-check"></i><b>6.4.1</b> <em>The data</em></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#panels-of-bivariate-plots"><i class="fa fa-check"></i><b>6.5</b> <em>Panels of bivariate plots</em></a></li>
<li class="chapter" data-level="6.6" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#check-for-multi-collinearity"><i class="fa fa-check"></i><b>6.6</b> <em>Check for multi-collinearity</em></a></li>
<li class="chapter" data-level="6.7" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#run-the-regression"><i class="fa fa-check"></i><b>6.7</b> <em>Run the regression</em></a></li>
<li class="chapter" data-level="6.8" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#interpret-the-regression"><i class="fa fa-check"></i><b>6.8</b> <em>Interpret the regression</em></a></li>
<li class="chapter" data-level="6.9" data-path="introduction-to-linear-regression.html"><a href="introduction-to-linear-regression.html#citations-2"><i class="fa fa-check"></i><b>6.9</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>7</b> Introduction to Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#learning-objectives-5"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#new-functions-syntax-5"><i class="fa fa-check"></i><b>7.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#measuring-biodiversity-the-data"><i class="fa fa-check"></i><b>7.3</b> Measuring biodiversity: the data</a></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#anova-overview"><i class="fa fa-check"></i><b>7.4</b> ANOVA overview</a></li>
<li class="chapter" data-level="7.5" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#anova-in-r"><i class="fa fa-check"></i><b>7.5</b> ANOVA in R</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#checking-assumptions-1"><i class="fa fa-check"></i><b>7.5.1</b> <em>Checking assumptions</em></a></li>
<li class="chapter" data-level="7.5.2" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#running-the-anova"><i class="fa fa-check"></i><b>7.5.2</b> <em>Running the ANOVA</em></a></li>
<li class="chapter" data-level="7.5.3" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#post-hoc-comparisons"><i class="fa fa-check"></i><b>7.5.3</b> <em>Post hoc comparisons </em></a></li>
<li class="chapter" data-level="7.5.4" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#interpreting-the-results"><i class="fa fa-check"></i><b>7.5.4</b> <em>Interpreting the results </em></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="introduction-to-analysis-of-variance-anova.html"><a href="introduction-to-analysis-of-variance-anova.html#citations-3"><i class="fa fa-check"></i><b>7.6</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><i class="fa fa-check"></i><b>8</b> Advanced data wrangling. Linking soil moisture with landcover and rainfall.</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#learning-objectives-6"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#new-functions-syntax-6"><i class="fa fa-check"></i><b>8.2</b> New functions &amp; syntax</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#soil-moisture"><i class="fa fa-check"></i><b>8.3</b> Soil moisture</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#soil-moisture-in-different-types-of-land-cover"><i class="fa fa-check"></i><b>8.3.1</b> Soil moisture in different types of land cover</a></li>
<li class="chapter" data-level="8.3.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#the-data-soil-moisture"><i class="fa fa-check"></i><b>8.3.2</b> The data: soil moisture</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#working-with-dates"><i class="fa fa-check"></i><b>8.4</b> Working with dates</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#the-lubridate-package"><i class="fa fa-check"></i><b>8.4.1</b> The lubridate package</a></li>
<li class="chapter" data-level="8.4.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#parsing-datetime"><i class="fa fa-check"></i><b>8.4.2</b> Parsing date/time</a></li>
<li class="chapter" data-level="8.4.3" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#extracting-information-from-dates"><i class="fa fa-check"></i><b>8.4.3</b> Extracting information from dates</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>8.5</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#filtering-data"><i class="fa fa-check"></i><b>8.5.1</b> Filtering data</a></li>
<li class="chapter" data-level="8.5.2" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#joining-data-tables"><i class="fa fa-check"></i><b>8.5.2</b> Joining data tables</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#conclusions"><i class="fa fa-check"></i><b>8.6</b> Conclusions</a></li>
<li class="chapter" data-level="8.7" data-path="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html"><a href="advanced-data-wrangling.-linking-soil-moisture-with-landcover-and-rainfall..html#citations-4"><i class="fa fa-check"></i><b>8.7</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-linear-regression" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Introduction to linear regression<a href="introduction-to-linear-regression.html#introduction-to-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>by Heather Kropp</em>
<em>for ENVST 206: Introduction to Environmental Data</em>
<em>Hamilton College</em></p>
<div id="learning-objectives-4" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Learning objectives<a href="introduction-to-linear-regression.html#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Work with data collected from satellites to examine the impact of beavers on the tundra</li>
<li>Use citizen science data examine the timing of spring leaf out</li>
<li>Learn how to conduct a linear regression in R</li>
<li>Interpret statistical output in R</li>
<li>Use the <code>ifelse</code> and <code>par</code> function for formatting data and plots</li>
</ol>
</div>
<div id="new-functions-syntax-4" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> New functions &amp; syntax<a href="introduction-to-linear-regression.html#new-functions-syntax-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>par</code>, <code>ifelse</code>,<code>lm</code>, <code>rstandard</code>, <code>qqnorm</code>, <code>qqline</code>, <code>plot( ~ x1 + x2 + .. xn)</code>, <code>par</code>, <code>ifelse</code></p>
</div>
<div id="simple-linear-regression-are-beavers-flooding-the-arctic" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Simple linear regression: Are beavers flooding the Arctic?<a href="introduction-to-linear-regression.html#simple-linear-regression-are-beavers-flooding-the-arctic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-data-2" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> <em>The data</em><a href="introduction-to-linear-regression.html#the-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Measures of surface water, vegetation, and land cover/use are commonly derived from satellite observations. Once these features are quantified from the imagery, these repeated observations over time can be used to examine changes in water and the land surface.</p>
<p>Throughout the last couple decades, beavers have notably been moving outside of their typical habitats and colonizing the Arctic tundra. You will start by working with a data collected by Jones <em>et al.</em> using measurements of surface water area taken from satellite imagery and surveys of beaver dams. Beaver dams result in flooding around the bodies of water, and this increase in beaver populations may affect the hydrology and carbon cycling in the Arctic. Below you can see an example of how these measurements were collected.</p>
<center>
<p><img src="photos/tutorial_5/Selawik_Lake_by_Sentinel-2.jpg" /></p>
<em>Example of Satellite imagery that can be used to measure and characterize lakes and surface water. Image credit: Contains modified Copernicus Sentinel data 2018, CC BY-SA 3.0 IGO, via Wikimedia Commons.</em>
</center>
<p>Surface water can be seen as the black areas in the photographs. Above the red arrow indicates the presence of the beaver dam that appeared in 2012 and the subsequent flooding. Yellow arrows indicate the areas where the frozen ground (permafrost) is beginning to thaw due to the newly formed surface water coverage.</p>
<p>Jones and his coauthors analyzed satellite imagery to identify the presence of beaver dams and changes in surface water in the Baldwin Peninsula Alaska. We will work with the data that examines the surface water area and the number of beaver dams over almost two decades in the tundra.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="introduction-to-linear-regression.html#cb130-1" tabindex="-1"></a>datB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/cloud/project/activity05/beaver_dam.csv&quot;</span>)</span>
<span id="cb130-2"><a href="introduction-to-linear-regression.html#cb130-2" tabindex="-1"></a><span class="fu">head</span>(datB)</span></code></pre></div>
<pre class="bg-info"><code>  year dams.n area.ha
1 2002      2     594
2 2007      6     610
3 2008      7     623
4 2009     10     600
5 2010     15     618
6 2011     31     625</code></pre>
<p>Here, we are interested in evaluating whether the presence of beaver dams is increasing surface water in the tundra. You will want to focus on the <code>dams.n</code> column which contains the total number of beaver dams in the area and the total area of surface water in hectares: <code>area.ha</code>.</p>
<p>Let’s start by taking a look at the data. Here you will make a <strong>scatter plot</strong> to visualize the data. You can use the <code>plot</code> function with to generate a scatter plot with x and y data. You will also notice that I am labeling the axes (with units!!!) and specifying that filled in points should be used.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="introduction-to-linear-regression.html#cb132-1" tabindex="-1"></a><span class="fu">plot</span>(datB<span class="sc">$</span>dams.n, datB<span class="sc">$</span>area.h, </span>
<span id="cb132-2"><a href="introduction-to-linear-regression.html#cb132-2" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb132-3"><a href="introduction-to-linear-regression.html#cb132-3" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;royalblue4&quot;</span>,</span>
<span id="cb132-4"><a href="introduction-to-linear-regression.html#cb132-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Surface water area (ha)&quot;</span>,</span>
<span id="cb132-5"><a href="introduction-to-linear-regression.html#cb132-5" tabindex="-1"></a>     <span class="at">xlab =</span>  <span class="st">&quot;Number of beaver dams&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
</div>
<div id="set-up-the-regression" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> <em>Set up the regression</em><a href="introduction-to-linear-regression.html#set-up-the-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just by looking at the scatter plot, the relationship looks fairly linear. The <code>lm</code> argument is used to specify a linear model. This is the function that will run the linear regression and provide all of the test information. Many of the linear regression assumptions are related to the <strong>residuals</strong>. You have to run the regression in order to look at the residuals. Note that this is a little different than previous hypothesis tests that required running the assumption checks before running the test. The <code>rstandand</code> function returns standardized residuals.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="introduction-to-linear-regression.html#cb133-1" tabindex="-1"></a><span class="co">#set up regression</span></span>
<span id="cb133-2"><a href="introduction-to-linear-regression.html#cb133-2" tabindex="-1"></a>dam.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(datB<span class="sc">$</span>area.ha <span class="sc">~</span> datB<span class="sc">$</span>dams.n)</span>
<span id="cb133-3"><a href="introduction-to-linear-regression.html#cb133-3" tabindex="-1"></a><span class="co">#get standardized residuals</span></span>
<span id="cb133-4"><a href="introduction-to-linear-regression.html#cb133-4" tabindex="-1"></a>dam.res <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(dam.mod)</span></code></pre></div>
</div>
<div id="checking-assumptions" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> <em>Checking assumptions</em><a href="introduction-to-linear-regression.html#checking-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s assess all assumptions of the regression before interpreting results. First we’ll check normality of the residuals:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="introduction-to-linear-regression.html#cb134-1" tabindex="-1"></a><span class="co">#set up qq plot</span></span>
<span id="cb134-2"><a href="introduction-to-linear-regression.html#cb134-2" tabindex="-1"></a><span class="fu">qqnorm</span>(dam.res)</span>
<span id="cb134-3"><a href="introduction-to-linear-regression.html#cb134-3" tabindex="-1"></a><span class="co">#add qq line</span></span>
<span id="cb134-4"><a href="introduction-to-linear-regression.html#cb134-4" tabindex="-1"></a><span class="fu">qqline</span>(dam.res)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<p>You’ll notice that the points in the QQ plot mostly follow the line, but the last couple points deviate more from the line. You can also use the Shapiro-Wilks test if you are feeling unsure about whether this is significant enough to be non-normal.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="introduction-to-linear-regression.html#cb135-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(dam.res)</span></code></pre></div>
<pre class="bg-info"><code>
    Shapiro-Wilk normality test

data:  dam.res
W = 0.92993, p-value = 0.3793</code></pre>
<p>Next let’s check the residual plot. The <code>abline</code> function adds a line to a graph, and can be useful for visualizing patterns in residuals. A line at a residual value of zero can be used to assess if there are any trends in the residuals.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="introduction-to-linear-regression.html#cb137-1" tabindex="-1"></a><span class="co">#make residual plot</span></span>
<span id="cb137-2"><a href="introduction-to-linear-regression.html#cb137-2" tabindex="-1"></a><span class="fu">plot</span>(datB<span class="sc">$</span>dams.n, dam.res, </span>
<span id="cb137-3"><a href="introduction-to-linear-regression.html#cb137-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;beaver damns&quot;</span>, </span>
<span id="cb137-4"><a href="introduction-to-linear-regression.html#cb137-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;standardized residual&quot;</span>)</span>
<span id="cb137-5"><a href="introduction-to-linear-regression.html#cb137-5" tabindex="-1"></a><span class="co">#add a horizontal line at zero</span></span>
<span id="cb137-6"><a href="introduction-to-linear-regression.html#cb137-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<p>You can see that there are no major concerns about the regression assumptions around the residuals. You can go ahead and interpret the results.</p>
</div>
<div id="interpreting-results" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> <em>Interpreting results</em><a href="introduction-to-linear-regression.html#interpreting-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can use the <code>summary</code> function to print out the regression table.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="introduction-to-linear-regression.html#cb138-1" tabindex="-1"></a><span class="fu">summary</span>(dam.mod )</span></code></pre></div>
<pre class="bg-info"><code>
Call:
lm(formula = datB$area.ha ~ datB$dams.n)

Residuals:
    Min      1Q  Median      3Q     Max 
-12.639  -7.191  -1.006   6.954  14.772 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 606.00410    4.13835 146.436  &lt; 2e-16 ***
datB$dams.n   0.31769    0.08037   3.953  0.00272 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 9.251 on 10 degrees of freedom
Multiple R-squared:  0.6097,    Adjusted R-squared:  0.5707 
F-statistic: 15.62 on 1 and 10 DF,  p-value: 0.002718</code></pre>
<p>It can also be helpful to view your regression line on your plot. Putting the regression model in the <em>abline</em> function will automatically draw the regression line.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="introduction-to-linear-regression.html#cb140-1" tabindex="-1"></a><span class="co">#make plot of beaver dams and surface water</span></span>
<span id="cb140-2"><a href="introduction-to-linear-regression.html#cb140-2" tabindex="-1"></a><span class="fu">plot</span>(datB<span class="sc">$</span>dams.n, datB<span class="sc">$</span>area.h, </span>
<span id="cb140-3"><a href="introduction-to-linear-regression.html#cb140-3" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb140-4"><a href="introduction-to-linear-regression.html#cb140-4" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;royalblue4&quot;</span>,</span>
<span id="cb140-5"><a href="introduction-to-linear-regression.html#cb140-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Surface water area (ha)&quot;</span>,</span>
<span id="cb140-6"><a href="introduction-to-linear-regression.html#cb140-6" tabindex="-1"></a>     <span class="at">xlab =</span>  <span class="st">&quot;Number of beaver dams&quot;</span>)</span>
<span id="cb140-7"><a href="introduction-to-linear-regression.html#cb140-7" tabindex="-1"></a><span class="co">#add regression line</span></span>
<span id="cb140-8"><a href="introduction-to-linear-regression.html#cb140-8" tabindex="-1"></a><span class="co">#make line width thicker</span></span>
<span id="cb140-9"><a href="introduction-to-linear-regression.html#cb140-9" tabindex="-1"></a><span class="fu">abline</span>(dam.mod, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<center>
<p><img src="_main_files/figure-html/unnamed-chunk-125-1.png" width="768" /></p>
</div>
</div>
<div id="multiple-linear-regression-what-makes-an-early-spring" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Multiple linear regression: What makes an early spring?<a href="introduction-to-linear-regression.html#multiple-linear-regression-what-makes-an-early-spring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-data-3" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> <em>The data</em><a href="introduction-to-linear-regression.html#the-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The time that leaves on deciduous trees unfurl from the leaf bud in the spring can impact forest temperatures, water cycling, and the overall productivity of forests. This unfurling of leaves in the spring is called <strong>leaf out</strong>. Warmer spring temperatures under climate change may result in deciduous plants becoming active earlier. The <em>United States Geological Survey’s National Phenology Network</em> collects data on the timing of plant activity and growth (aka <strong>phenology</strong>). The NPN relies on the work of plant scientists and interested volunteers, called <em>citizen scientists</em>. Many people can readily identify when leaf out is occurring, and dedicated citizen scientists help document where and when leaf out happens. This greatly increases the amount and spatial coverage of leaf out data beyond what research scientists are able to go out and observe themselves.</p>
<center>
<p><img src="photos/tutorial_5/leaf_bud.jpg" style="width:33.0%" /></p>
<em>Leaves beginning to unfurl from the leaf bud in the spring. Friedrich Haag / Wikimedia Commons / CC BY-SA 4.0</em>
</center>
<p>We will focus on the leaf out of the <em>red maple</em>, a tree common throughout the eastern United States.</p>
<center>
<p><img src="photos/tutorial_5/Acer_rubrum_range_map.png" style="width:33.0%" /></p>
<p><em>By U.S. Geological Survey - Digital representation of "Atlas of United States Trees" by Elbert L. Little, Jr. [1], Public Domain</em></p>
</center>
<p>Read in the data:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="introduction-to-linear-regression.html#cb141-1" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/cloud/project/red_maple_pheno.csv&quot;</span>)</span></code></pre></div>
<p>The data contains the day of year (<code>doy</code>) that leaf out occured and the year (<code>year</code>) of occurrence. Day of year counts the days in the year where January 1st is day of year 1 and December 31st (non-leap year) is day of year 365. There are also latitude (<code>Lat</code>) and longitude (<code>Long</code>) observations for each leaf out event. Latitude can be associated with differences in solar radiation and temperature. Longitude lower values of longitude will be further west in the continental US and higher values will represent more eastern areas up to the Atlantic coast. There are meteorological data that describes the general environmental conditions including the maximum temperature (<code>Tmax</code>, <span class="math inline">\(^\circ\)</span> C ), minimum temperature (<code>Tmin</code>, <span class="math inline">\(^\circ\)</span> C ), precipitation (<code>Prcp</code>, mm) for each location of measurement. There is also an elevation observation (<code>elev</code>, m). Higher elevations can be associated with colder temperatures and longer periods of snow cover. There is also a description of whether the site is urban or rural (<code>siteDesc</code>, “Urban” or “Rural”). The main variable of interest is the <code>doy</code> variable that describes when the leaf out occurred. Let’s take a look at how that is related to to variables like the maximum temperature and precipitation.</p>
</div>
</div>
<div id="panels-of-bivariate-plots" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> <em>Panels of bivariate plots</em><a href="introduction-to-linear-regression.html#panels-of-bivariate-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes it useful to view bivariate plots (two variables) side by side for a multiple regression. You can look at plots side by side using the <code>par</code> function. <code>par</code> specifies parameters around plotting and you can use arguments like <code>mfrow</code> to specify showing multiple plots in a panel. The <code>mfrow</code> argument needs a vector of two numbers for input. The first number should be the number of rows of plots in the panel and second is the number of columns of plots.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="introduction-to-linear-regression.html#cb142-1" tabindex="-1"></a><span class="co">#set up panel of plots with one row and two columns</span></span>
<span id="cb142-2"><a href="introduction-to-linear-regression.html#cb142-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb142-3"><a href="introduction-to-linear-regression.html#cb142-3" tabindex="-1"></a><span class="fu">plot</span>(pheno<span class="sc">$</span>Tmax,pheno<span class="sc">$</span>doy, </span>
<span id="cb142-4"><a href="introduction-to-linear-regression.html#cb142-4" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb142-5"><a href="introduction-to-linear-regression.html#cb142-5" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;royalblue4&quot;</span>,</span>
<span id="cb142-6"><a href="introduction-to-linear-regression.html#cb142-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Day of leaf out&quot;</span>,</span>
<span id="cb142-7"><a href="introduction-to-linear-regression.html#cb142-7" tabindex="-1"></a>     <span class="at">xlab =</span>  <span class="st">&quot;Maximum temperature (C)&quot;</span>)</span>
<span id="cb142-8"><a href="introduction-to-linear-regression.html#cb142-8" tabindex="-1"></a><span class="fu">plot</span>(pheno<span class="sc">$</span>Lat,pheno<span class="sc">$</span>doy, </span>
<span id="cb142-9"><a href="introduction-to-linear-regression.html#cb142-9" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb142-10"><a href="introduction-to-linear-regression.html#cb142-10" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;royalblue4&quot;</span>,</span>
<span id="cb142-11"><a href="introduction-to-linear-regression.html#cb142-11" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Day of leaf out&quot;</span>,</span>
<span id="cb142-12"><a href="introduction-to-linear-regression.html#cb142-12" tabindex="-1"></a>     <span class="at">xlab =</span>  <span class="st">&quot;Latitude (degrees)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-1.png" width="768" /></p>
<p>Rstudio will automatically default to using this <code>par</code> argument until you tell it to stop. You can either hit the <code>broom button</code> above the plot to clear your plotting area or you can also run the command:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="introduction-to-linear-regression.html#cb143-1" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="check-for-multi-collinearity" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> <em>Check for multi-collinearity</em><a href="introduction-to-linear-regression.html#check-for-multi-collinearity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Temperature appears to have an impact on the timing of leaf out, but we will want to see if other variables such as precipitation or elevation of the site may impact the timing of leaf out. Let’s see if there will be any issues looking at multiple variables at once. Let’s check for correlations. We’ll do a visual assessment and look at the correlations. You can use the plot function to generate a series of <strong>covariance plots</strong>. Covariance plots set up a matrix of plots and compares all possible combinations of variables. Notice that there is a formula used here, but there is no dependent variable only many independent variables that could be used in the regression.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="introduction-to-linear-regression.html#cb144-1" tabindex="-1"></a><span class="fu">plot</span>( <span class="sc">~</span>  pheno<span class="sc">$</span>Lat <span class="sc">+</span> pheno<span class="sc">$</span>Tmax<span class="sc">+</span> pheno<span class="sc">$</span>Tmin <span class="sc">+</span>pheno<span class="sc">$</span>Prcp <span class="sc">+</span> pheno<span class="sc">$</span>elev <span class="sc">+</span> pheno<span class="sc">$</span>siteDesc)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>You’ll notice that there are no real patterns between temperature and precipitation variables. However, variables such as latitude and both temperature variables look to have a tight linear relationship. Just visually you can see that including both latitude and the maximum temperature would be problematic. This is not surprising given that solar radiation plays a major role in warming the earth’s surface, and the input of solar radiation varies with latitude. In this case, we will want choose the variable that best represents the process and makes the most sense. Here, we know that temperature directly impacts metabolic activity and the ability of plants to come out of dormancy. Any patterns with latitude would likely be reflecting differences in temperature across latitude, and temperature is known to directly impact leaf out.</p>
</div>
<div id="run-the-regression" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> <em>Run the regression</em><a href="introduction-to-linear-regression.html#run-the-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s build a multiple regression that investigates the relationship between leaf out phenology and latitude, precipitation, longitude, and the urban/rural designation. You’ll notice the urban/rural designation is a character. You will want to code this as a zero and one for the regression. You can use the <code>ifelse</code> function to make this variable. <code>ifelse</code> uses three arguments: the first one is a logical statement to be evaluated, the second is a value to include in the vector if the statement is true, and the last is a value to include in the vector if statement is false.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="introduction-to-linear-regression.html#cb145-1" tabindex="-1"></a>pheno<span class="sc">$</span>urID <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pheno<span class="sc">$</span>siteDesc <span class="sc">==</span> <span class="st">&quot;Urban&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<p>Note that this will be a binary variable in our regression.You will think a little bit more about how to interpret those results after you run the regression.</p>
<p>The multiple regression set up in R will look similar to the simple linear regression:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="introduction-to-linear-regression.html#cb146-1" tabindex="-1"></a>mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(pheno<span class="sc">$</span>doy <span class="sc">~</span>  pheno<span class="sc">$</span>Lat <span class="sc">+</span> pheno<span class="sc">$</span>Prcp <span class="sc">+</span> pheno<span class="sc">$</span>Long <span class="sc">+</span> pheno<span class="sc">$</span>urID)</span></code></pre></div>
<p>Notice how instead of one variable there is now an added plus sign for each new variable. Now you can evaluate the assumptions just like the simple linear regression (assuming you already looked at multicollinearity before running the regression).</p>
<p>Note that there are 1,244 observations in this data and the Shapiro Wilks test is not meant for data with more than 1,000 observations. You will want to use the qqnorm evaluation:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="introduction-to-linear-regression.html#cb147-1" tabindex="-1"></a><span class="co">#get residuals</span></span>
<span id="cb147-2"><a href="introduction-to-linear-regression.html#cb147-2" tabindex="-1"></a>mlr.res <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(mlr)</span>
<span id="cb147-3"><a href="introduction-to-linear-regression.html#cb147-3" tabindex="-1"></a><span class="co">#check normality</span></span>
<span id="cb147-4"><a href="introduction-to-linear-regression.html#cb147-4" tabindex="-1"></a><span class="fu">qqnorm</span>(mlr.res)</span>
<span id="cb147-5"><a href="introduction-to-linear-regression.html#cb147-5" tabindex="-1"></a><span class="fu">qqline</span>(mlr.res)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>You also will want to use the fitted values for your regression in your residual plot given that there are multiple covariates in this case. You can calculate the <strong>fitted values</strong> from the regression line for each observation using the <code>fitted</code> function:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="introduction-to-linear-regression.html#cb148-1" tabindex="-1"></a><span class="co">#get fitted values</span></span>
<span id="cb148-2"><a href="introduction-to-linear-regression.html#cb148-2" tabindex="-1"></a>mlFitted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(mlr)</span>
<span id="cb148-3"><a href="introduction-to-linear-regression.html#cb148-3" tabindex="-1"></a></span>
<span id="cb148-4"><a href="introduction-to-linear-regression.html#cb148-4" tabindex="-1"></a><span class="co">#make residual plot</span></span>
<span id="cb148-5"><a href="introduction-to-linear-regression.html#cb148-5" tabindex="-1"></a><span class="fu">plot</span>(mlFitted,mlr.res,<span class="at">pch=</span><span class="dv">19</span>, </span>
<span id="cb148-6"><a href="introduction-to-linear-regression.html#cb148-6" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;regression fitted values&quot;</span>,</span>
<span id="cb148-7"><a href="introduction-to-linear-regression.html#cb148-7" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;residual&quot;</span>)</span>
<span id="cb148-8"><a href="introduction-to-linear-regression.html#cb148-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p><em>Does it seem strange to you that there are many data points at the same x value in this graph? What about in the bivariate plots of temperature? If it does seem strange, good eye! We will cover these issues in the homework.</em></p>
</div>
<div id="interpret-the-regression" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> <em>Interpret the regression</em><a href="introduction-to-linear-regression.html#interpret-the-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next let’s look at the regression table to evaluate the relationships with leaf out.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="introduction-to-linear-regression.html#cb149-1" tabindex="-1"></a><span class="fu">summary</span>(mlr)</span></code></pre></div>
<pre class="bg-info"><code>
Call:
lm(formula = pheno$doy ~ pheno$Lat + pheno$Prcp + pheno$Long + 
    pheno$urID)

Residuals:
    Min      1Q  Median      3Q     Max 
-53.943 -11.547  -1.155  10.346  52.796 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 76.780740  11.258812   6.820 1.65e-11 ***
pheno$Lat    2.699841   0.213306  12.657  &lt; 2e-16 ***
pheno$Prcp   0.023409   0.004544   5.152 3.16e-07 ***
pheno$Long   1.107019   0.051204  21.620  &lt; 2e-16 ***
pheno$urID  -6.064702   1.480484  -4.096 4.56e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 16.92 on 924 degrees of freedom
  (315 observations deleted due to missingness)
Multiple R-squared:  0.6168,    Adjusted R-squared:  0.6152 
F-statistic: 371.9 on 4 and 924 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Let’s think a little more about how this urban/rural variable and how to interpret it in a regression. Keep in mind that urban built environments can have surfaces that are typically much warmer than surrounding natural vegetated environments. Dark paved surfaces and buildings absorb greater levels of solar radiation, resulting in higher temperatures in the immediate urban area. Remember urban sites will be marked with a one and rural areas are marked with a zero. Consider the interpretation of the slope coefficient <em>x<sub>1</sub></em> versus <em>x<sub>0</sub></em>. Remember urban sites will be marked with a one and rural areas are marked with a zero.</p>
<center>
<img src="_main_files/figure-html/unnamed-chunk-136-1.png" width="768" />
</center>
<center>
<img src="_main_files/figure-html/unnamed-chunk-137-1.png" width="768" />
</center>
</div>
<div id="citations-2" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Citations<a href="introduction-to-linear-regression.html#citations-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong><em>Beavers &amp; surface water</em></strong></p>
<p>Jones, Benjamin M., et al. “Increase in beaver dams controls surface water and thermokarst dynamics in an Arctic tundra region, Baldwin Peninsula, northwestern Alaska.” <em>Environmental Research Letters</em> 15.7 (2020): 075005.</p>
<p><strong><em>Red maple phenology</em></strong></p>
<p>USA-NPN National Coordinating Office. 2016. USA National
Phenology Network data product development framework and data product
catalog, v 1.1. USA-NPN Technical Series 2016-001. www.usanpn.org.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-hypothesis-testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-analysis-of-variance-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
